<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Yang Liu fr]]></title>
  <subtitle><![CDATA[a meiobenthologist's blog]]></subtitle>
  <link href="http://yangliufr.com/atom.xml" rel="self"/>
  <link href="http://yangliufr.com"/>
  <updated>2014-03-01T23:59:08.559Z</updated>
  <id>http://yangliufr.com/</id>
  <author>
    <name><![CDATA[Yang Liu]]></name>
    <email><![CDATA[youngleoyzu@gmail.com]]></email>
  </author>
  <generator uri="http://zespia.tw/hexo">Hexo</generator>
  <entry>
    <title type="html"><![CDATA[菜鸟学R语言：结合文献数据库，分析学科发展概况]]></title>
    <link href="http://yangliufr.com/2014/02/05/use-r-to-analyse-literatures-to-get-a-research-trend/"/>
    <id>http://yangliufr.com/2014/02/05/use-r-to-analyse-literatures-to-get-a-research-trend/</id>
    <published>2014-02-05T00:00:00.000Z</published>
    <updated>2014-02-05T23:44:20.000Z</updated>
    <content type="html"><![CDATA[<p>最近因为图卢兹总是下雨，河水水位居高不下，所以，我就赋闲了。我从来也不是一个务正业的人，有了时间，除了看文献之外，总要干点什么。这次时间充裕，加上导师让我不要着急，我心里只能嘀咕着，我可不想延期毕业。于是，有了时间自由支配，所以，就琢磨着完成一开始学R的时候想要完成的一个idea，就是，根据文献搜索结果，来进行分析预测学科发展走势。
<a id="more"></a></p>
<p>当然，想法总是丰满，现实总是骨感的。经过两天的钻研，也只能摸到个text mining（文本挖掘）课堂之外楼道转角楼梯口的男厕所的冰山一角。我对这方面的兴趣和知识储备是呈反比的，但丝毫没有影响我不务正业的脚步。这次，我就讲讲思路，代码就不贴了，有兴趣的可以自己搞出来，或者想办法联系我，大牛的话，就当做看看儿时的自己吧。</p>
<h3 id="-endnote-">从EndNote中导出文献数据</h3>
<p>为什么要用EndNote呢？我曾花了不少时间研究抓取谷歌学术的搜索结果，但是每次都很快被谷歌封掉IP。原因是，我没有对脚本进行浏览器伪装，和设置每次请求的间隔时间等。本着结果导向的思想，我转向了EndNote强大的软件内文献数据库搜索功能。</p>
<p>所以，第一步就是确定你要搜索的关键词，在这里，我比较关注“meiofauna”，于是就在title或者keywords，或者全文中对此关键词进行搜索，得到包含它的文献题录。</p>
<p><img src="/img/literature-analysis-1.png" alt="literature-analysis-1"></p>
<p>我总共得到了623条文献题录，ctrl+A全选转移到library的某个group里面，然后点击这个group，再点击左上角的file——export，另存为xml格式文件即可。这样就把所有的文献题录都保存到一个文件中了。</p>
<h3 id="-r-xml-">抓取有用信息的工作都由R的XML包来完成</h3>
<p>这里不赘述了，我以前的几篇博文中提到过如何抓取网页数据，其中最主要的就是xpath的知识，firefox和chrome中都有插件可以找到网页中某个node的地址，这次是保存下来的文件，和之前稍有不同，也就是说不能偷懒了，建议大家去<a href="http://www.w3school.com.cn/xpath/" target="_blank">w3cschool的网站</a>看看。没有什么难点，除了这些具体的用哪个包，还有就是代码习惯，很重要很重要，很多时间出现bug，都是因为数据格式不对，很多变量保存来保存去的，用了一些function之后，格式就变了，所以，这种习惯需要一点一点养成，我还差得远呢，毕竟不是天天写。</p>
<h3 id="-">用什么方法去分析抓取下来的数据呢？</h3>
<p>我抓取下来的数据包括了每篇论文的标题、出版日期、摘要、作者单位地址，这四项最主要的内容。其中摘要是一个庞大的语料库，我也试着做了一下词频分析，但我做着做着，就感觉知识匮乏，搞不下去了。我的想法很简单，就是看横坐标时间为单位，某一些关键词的词频是随时间增大还是减少。我能把这些都实现，但是这个结果是不是真实的，还是需要强大的模型思维来奠基。</p>
<p>于是，我转而关注作者的单位地址，从中提取出国家名称，从而计算国家名称出现的频率，看其随时间变化的趋势，这样，也能从时间跨度上了解某方向的进展，可以间接帮助自己以后去哪儿找博后定方向。</p>
<p>这样，思路逐渐清晰。我问了谷歌，哪儿有全球国家名称列表，找到了个网站，用<code>readHTMLTable</code>这个函数来读取了国家名称，再用<code>grepl</code>来判断地址文本中是否含有某个国家的名称。这一步我要说一下，我原本的思路是，把地址文本分词，然后用<code>match</code>来判断，但这样处理的精确度完全依赖于分词的方法，而题录信息里的地址文本不是标准的有句号的文章，有的逗号后面有空格，有的没有空格或者多个空格，所以，很难用一种方法得到所有国家名称的匹配，再加上像south africa这样的国家，就让你不能用space作为分词依据。因此，在尝试了很长时间后，我放弃了。而现在用的<code>grepl</code>这个方法很有效，让我用5行代码就搞定了原来的几十行。</p>
<h3 id="-googlevis-">用<code>googleVis</code>画图</h3>
<p>这里参考了某大神的博客（需翻墙<a href="http://xccds1977.blogspot.fr/2011/09/test_901.html" target="_blank">link</a>），就没有使用<code>rworldmap</code>这个包，而使用了<code>googleVis</code>。因为前者要求在画图时，把国家名称转化为国家代码，虽然有<code>countrycode</code>这个包可以转换，但还是不如<code>googleVis</code>方便。于是，一气呵成，完成了以下以年代划分的五张图。</p>
<p>1970~2014年，对meiofauna有研究的国家示意图。</p>
<html><!-- IntensityMap generated in R 3.0.2 by googleVis 0.4.7 package -->  <!-- Thu Feb 06 00:34:13 2014 -->      <!-- jsHeader -->  <script type="text/javascript">     function gvisDataIntensityMapID22f07e9551de () {  var data = new google.visualization.DataTable();  var datajson =  [   [   &quot;AU&quot;,  0,  7,  2,  3,  5   ],  [   &quot;AT&quot;,  1,  1,  1,  0,  2   ],  [   &quot;BE&quot;,  3,  11,  11,  5,  23   ],  [   &quot;BR&quot;,  0,  4,  6,  4,  9   ],  [   &quot;CA&quot;,  2,  9,  3,  4,  6   ],  [   &quot;CL&quot;,  0,  0,  1,  2,  1   ],  [   &quot;CN&quot;,  1,  2,  0,  2,  3   ],  [   &quot;CR&quot;,  0,  1,  0,  1,  1   ],  [   &quot;HR&quot;,  2,  4,  2,  1,  2   ],  [   &quot;DK&quot;,  3,  1,  2,  0,  6   ],  [   &quot;EG&quot;,  1,  3,  0,  0,  1   ],  [   &quot;GB&quot;,  2,  13,  11,  11,  17   ],  [   &quot;FI&quot;,  1,  3,  2,  4,  2   ],  [   &quot;FR&quot;,  3,  13,  6,  6,  13   ],  [   &quot;DE&quot;,  3,  13,  14,  7,  18   ],  [   &quot;GR&quot;,  0,  1,  0,  0,  1   ],  [   &quot;HK&quot;,  1,  1,  1,  2,  1   ],  [   &quot;IN&quot;,  3,  11,  6,  4,  13   ],  [   &quot;ID&quot;,  0,  0,  0,  0,  1   ],  [   &quot;IR&quot;,  0,  1,  0,  0,  1   ],  [   &quot;IT&quot;,  4,  9,  13,  3,  16   ],  [   &quot;JM&quot;,  0,  0,  0,  0,  1   ],  [   &quot;JP&quot;,  0,  0,  0,  0,  3   ],  [   &quot;KE&quot;,  0,  0,  0,  0,  2   ],  [   &quot;LV&quot;,  0,  0,  0,  0,  1   ],  [   &quot;ML&quot;,  0,  0,  0,  0,  3   ],  [   &quot;MX&quot;,  0,  1,  1,  1,  1   ],  [   &quot;NL&quot;,  1,  8,  2,  2,  5   ],  [   &quot;NO&quot;,  0,  0,  1,  0,  2   ],  [   &quot;PL&quot;,  2,  5,  4,  0,  6   ],  [   &quot;PT&quot;,  0,  1,  2,  1,  3   ],  [   &quot;RU&quot;,  1,  1,  1,  0,  1   ],  [   &quot;SA&quot;,  0,  0,  0,  1,  1   ],  [   &quot;ZA&quot;,  6,  13,  8,  6,  5   ],  [   &quot;ES&quot;,  3,  8,  6,  2,  5   ],  [   &quot;SE&quot;,  2,  4,  6,  2,  11   ],  [   &quot;TZ&quot;,  0,  0,  0,  0,  1   ],  [   &quot;TH&quot;,  0,  0,  0,  0,  1   ],  [   &quot;TR&quot;,  0,  0,  0,  0,  1   ],  [   &quot;US&quot;,  18,  34,  24,  9,  33   ],  [   &quot;VE&quot;,  0,  0,  1,  0,  1   ],  [   &quot;RS&quot;,  0,  0,  0,  2,  2   ]   ];  data.addColumn(&#39;string&#39;,&#39;country1&#39;);  data.addColumn(&#39;number&#39;,&#39;1970~1980&#39;);  data.addColumn(&#39;number&#39;,&#39;1980~1990&#39;);  data.addColumn(&#39;number&#39;,&#39;1990~2000&#39;);  data.addColumn(&#39;number&#39;,&#39;2000~2010&#39;);  data.addColumn(&#39;number&#39;,&#39;2010~2014&#39;);  data.addRows(datajson);  return(data);  }     function drawChartIntensityMapID22f07e9551de() {  var data = gvisDataIntensityMapID22f07e9551de();  var options = {};  options[&quot;width&quot;] =    600;  options[&quot;colors&quot;] = [&#39;#4682b4&#39;, &#39;#4682b4&#39;, &#39;#4682b4&#39;, &#39;#4682b4&#39;, &#39;#4682b4&#39;];          var chart = new google.visualization.IntensityMap(      document.getElementById(&#39;IntensityMapID22f07e9551de&#39;)      );      chart.draw(data,options);          }         (function() {  var pkgs = window.<strong>gvisPackages = window.</strong>gvisPackages || [];  var callbacks = window.<strong>gvisCallbacks = window.</strong>gvisCallbacks || [];  var chartid = &quot;intensitymap&quot;;      var i, newPackage = true;  for (i = 0; newPackage &amp;&amp; i &lt; pkgs.length; i++) {  if (pkgs[i] === chartid)  newPackage = false;  }  if (newPackage)    pkgs.push(chartid);      callbacks.push(drawChartIntensityMapID22f07e9551de);  })();  function displayChartIntensityMapID22f07e9551de() {    var pkgs = window.<strong>gvisPackages = window.</strong>gvisPackages || [];    var callbacks = window.<strong>gvisCallbacks = window.</strong>gvisCallbacks || [];    window.clearTimeout(window.<strong>gvisLoad);    window.</strong>gvisLoad = setTimeout(function() {    var pkgCount = pkgs.length;    google.load(&quot;visualization&quot;, &quot;1&quot;, { packages:pkgs, callback: function() {    if (pkgCount != pkgs.length) {    return;  }  while (callbacks.length &gt; 0)  callbacks.shift()();  } });  }, 100);  }     </script>     <!-- jsChart -->    <script type="text/javascript" src="https://www.google.com/jsapi?callback=displayChartIntensityMapID22f07e9551de"></script>     <!-- divChart -->      <div id="IntensityMapID22f07e9551de"    style="width: 600px; height: 500px;">  </div></html>


<h3 id="-">结论</h3>
<p>初步分析可以看出，美国一直处于领先地位，德国、法国、西班牙、意大利和加拿大是仅次于美国，处于第二梯队，南美洲也从无到有持续发展着，非洲的南非一枝独秀，亚洲的印度是第一名，中国以及东亚国家在这方面非常落后，澳大利亚一直不温不火，应该也可以算是第二梯队。如果欧洲以欧盟为单位计算的话，应该会和美国持平。</p>
<p>所以，国内还是很需要研究meiofauna的人才的。</p>
<p><strong>后话：</strong></p>
<p>其实，这篇文章所提供的思路可以举一反三的，比如，我可以每搜索一个关键词，导出一个xml文件，然后对若干个xml文件进行分析，这样就不是单一的单个关键词了，所分析的结果也更能代表具体的某个研究方向了。希望能对大家有所帮助。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/菜鸟学R语言/" term="菜鸟学R语言"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[在巴黎的一夜——参加中法建交50周年纪念晚会]]></title>
    <link href="http://yangliufr.com/2014/01/28/one-night-in-paris-the-so-called-50-anniversary-ceremony-of-fr-cn-HH/"/>
    <id>http://yangliufr.com/2014/01/28/one-night-in-paris-the-so-called-50-anniversary-ceremony-of-fr-cn-HH/</id>
    <published>2014-01-28T00:00:00.000Z</published>
    <updated>2014-01-28T20:19:49.000Z</updated>
    <content type="html"><![CDATA[<p>我想，我这篇博文的题目有一定的吸引力，但可能我将要写的内容会让你们失望了，因为我也是带着失望之情离开了第一次去的巴黎，这座很多人梦寐以求要去的城市。
<a id="more"></a></p>
<p>当时接到学校的邮件，要我们这些在图卢兹的中国留学生报名参加这次在巴黎大皇宫举办的纪念中法建交50周年的中国之夜晚会的时候，我和我的同学们都积极报名，感到非常荣幸和自豪，因为如此high-profiled的活动应该是机会难得，也很想看到宣传册中列举到的演出嘉宾朗朗的钢琴表演。对我个人来说，能有一次免费去巴黎参加如此重要活动的机会，一向对旅游提不起兴趣的我，也毫不犹豫的报了名，并跟导师请了两天假。</p>
<h3 id="-">巴黎印象</h3>
<p>早上五点半起床，坐上了学校提供的开往巴黎的大巴车，混混沌沌的十个小时后，我们到了巴黎。印象，和图卢兹相比，巴黎就是一个字，大。一切都那么熟悉，但一切都仿佛大了一号。更宽的马路，更大的品牌专卖店，更多的景点，更宏伟的建筑。走在香榭丽舍大街上，感觉仿佛回到了国内一样，没有了在图卢兹紧凑狭窄的市中心街道，置身于一偏灯红酒绿之中了。巴黎，应该是世界人民眼中的法国，但不是法国人眼中的法国。相较而言，图卢兹则更有一番韵味在。下次，如果有时间，我还会再来细细品味这座城市。这次的到此一游显然是管中窥豹的。</p>
<h3 id="-">排队</h3>
<p>草草地对巴黎有了个第一印象之后，就要来到巴黎大皇宫前排队准备入场观演。近乎一百多米长的队伍井然有序的向前蠕动着，时间也慢慢跳过约定的入场时间，零上两度的气温，配上金黄的路灯和车水马龙，即便是冷，心还是热的。直到我们在将要通过最后一关-安检的时候，内心的火热正在悄然转变。我们被告知，会场里面已经客满，无法再容纳更多的客人入内观看表演，于是有大概一两百人，应该都是在法留学生，被挡在了大门之外，甚至其中大部分还在干燥但刺骨的寒风中等待着。</p>
<p>时间就这样一分一分过去了，原定在六点半入场的活动，我们等了两个小时，也未能看到甚至听到任何负责人出面向我们解释。我们所能得到的信息就是，已经进去的同学发来的短信，有的说朗朗已经表演完了，有的说朗朗还在美国参加格莱美颁奖典礼，有的说这个活动可能要优先于社会上流人士观看，等等猜测和揣摩，以及慢慢发酵的愤怒。还在外面排队的其他同胞们，甚至用法语喊起了，“我们很饿，我们很冷！”（如果我没听错的话）。</p>
<p>又过了十几分钟，我们终于进去了。没有看到大使，没有听到致辞，只有一些看似具有中国特色的表演，但都加入了法国人认为的时尚进去的草泥马艺术（四不像），然后，喝了点小酒，吃了点小点心之后，我和一部分同学就离开了，以此表达我们对活动组织者的不满。</p>
<h3 id="-">思考</h3>
<p><strong>为什么会造成与会人员都持有邀请函的情况下，还让这么多人未能按时进入会场，滞留在场外受冻不说，至始至终没有任何负责人出面对此进行解释？</strong></p>
<p>我们不是看到免费的活动就来，看到有队伍就排的，我们来之前都持有着活动的邀请函，而且，不是所有人都能拿到这个邀请函，也是经过报名和筛选的。如果活动组织者为了不造成活动冷场，而对邀请函进行超发，想主观提升活动人气，但又没有任何准备应对如此屁股都能想到的突发情况，这又是为什么？是学生群体好欺负吗？这个话题，我不是很想去多想去展开谈，因为这有可能是我的臆想和片面的猜测，但这的确是可能性之一。</p>
<p>作为我个人，我当时只是希望，能有一个人，任何有发言权的负责人，法方也好，中方也好，能够走出会场，来到外场对还在排队的人们解释一下情况，给予适当的安置，而不是仅仅调派警车来“镇压”可能的躁动。我想，如果我们不是中国学生，中国人，如果是意大利人或者就是他们法国人，他们会这么对待吗？我其实也在反思我自己，自己始终也没有那个思维和习惯去主动伸张自己遭遇的不公正对待。而更多的同学，选择的是逆来顺受，得到的经验就是，下次即便有邀请函，也要早早地来排队。我想，这也许就是中国人的聪明吧。其实，逆来顺受是对的，因为这最大限度的，最有效率和时效的保护了部分当事人的权利，但牺牲了“自然选择”之外那部分人的利益，这是人的本能，无可厚非。</p>
<p>但在这样的外交活动场合，出现了如此一幕的不妥善，实属不应该。可能，这对于没有当场经历的读者来说，仅仅是一次吃不到葡萄说葡萄酸，和吃到了酸葡萄的心理，我也可以理解。对我来说，这一次经历只是徒增愤慨，给了自己一个话作料儿，因为这件事在以后的很多谈话场合都用得到，“左右”都适用。很多可能的由此引出的话题就留在那时，再去展开吧。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/一些思考/" term="一些思考"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[用R抓取NBA球员数据]]></title>
    <link href="http://yangliufr.com/2014/01/14/use-r-crawl-NBA-players-data-analyse-constellation-1/"/>
    <id>http://yangliufr.com/2014/01/14/use-r-crawl-NBA-players-data-analyse-constellation-1/</id>
    <published>2014-01-14T00:00:00.000Z</published>
    <updated>2014-01-14T13:50:35.000Z</updated>
    <content type="html"><![CDATA[<p>上周末抽了一天时间学习django，可惜自己编程基础不好，对python语法很不熟悉，搞得自己灰头土脸，没啥成就感。搜到了一篇<a href="http://logos.name/archives/52" target="_blank">博文</a>，博主是在虎扑体育任职，文中简要描述了如何用django框架创建app来抓取NBA球员数据的例子。我依葫芦画瓢都没能复制成功，在R中一个script就搞定一切的思路，在其他真正的编程语言面前，顿显R在网页动态呈现方面的软肋。</p>
<a id="more"></a>

<p>其实，论功能和解决问题的专注程度，我眼中的R是最简单直接的，可能因为我对python不熟悉吧，但有人表示<a href="http://www.talyarkoni.org/blog/2013/11/18/the-homogenization-of-scientific-computing-or-why-python-is-steadily-eating-other-languages-lunch/" target="_blank">python正在蚕食R在科研计算方面的蛋糕</a>，也验证了我平时如果想用R做除了分析数据，画图，抓取网页数据之外的事情时，比如建网站，打包程序等，发现R有点捉襟见肘的想法了。所以，我才动了要学python的念头，但学一门外语是多么不容易啊。</p>
<p>R应该是我计算机语言中的母语，虽然大学里学过fortran，但为了考试学的知识毕竟不是那么牢固。我学习R的过程，就是先有问题，再去寻找R中可能的解决方案的，然后在这个过程中慢慢体会这门语言的过程。感觉就像老板拍脑门要做个什么事，就告诉下属去做，然后给我结果一样，只不过我既是老板又是下属。</p>
<p>接着第一段说，有了学django的挫败感之后，我为了寻找慰藉，又打开了Rstudio，希望能找回那顺畅熟悉的感觉。果然，同样的事情，很快就解决了，可谓驾轻就熟。可能django里牵扯到更多的编程思想，从model.py，view.py到setting.py，admin.py，这些只是网页后台框架，还要写app的model.py。在我上手试用后，感觉非常生涩，对library、function、model的命名规则不太习惯，说白了，压根没入门。所以，我还要多花时间去啃着块骨头。</p>
<p>好了，以上都是本文的题外话或者前情提要吧。我既然又用回R来抓取数据了，就将代码分享出来吧。</p>
<h3 id="-">先分析再抓取</h3>
<p>点开球员页面的<a href="http://www.basketball-reference.com/players/" target="_blank">链接</a>，发现是按照姓名排序的。</p>
<p><img src="/img/basketball-reference-1.png" alt="basketball-reference-1"></p>
<p>而且，点进去某个字母链接，就可以直接得到所有的球员，这是最赞的，也是对抓取技能要求最低的了。所以，第一步就要抓取这个页面上的所有字母链接，再打开每个字母链接，抓取所有数据。很纳闷，居然NBA球员没有姓Xavier的，导致X字母下面居然没有一个人。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="keyword">library</span>(XML)
<span class="keyword">library</span>(RCurl)

url = <span class="string">"http://www.basketball-reference.com/players/"</span>
get_url = getURL(url, encoding = <span class="string">"UTF-8"</span>)
get_url_parse = htmlParse(get_url, encoding = <span class="string">"UTF-8"</span>)
url_player_initial = xpathSApply(get_url_parse, <span class="string">"//tr/td[1]/a"</span>, <span class="keyword">function</span>(x) c(xmlAttrs(x)[[<span class="string">"href"</span>]]))
url_modify = <span class="string">"http://www.basketball-reference.com"</span>
url_player_all = sapply(url_player_initial, <span class="keyword">function</span>(x) paste(url_modify,x,sep=<span class="string">""</span>))

data_player_all = sapply(url_player_all, <span class="keyword">function</span>(x) readHTMLTable(x))
</pre></td></tr></table></figure>

<p>在表中有粗体的名字，意思是现役球员，也可以单独标注出来，这里我就通过判断是否在2014年还在服役来确定是否现役，最后结果比直接抓取现役球员要少，可能因为有的球员有伤病，或者被下放到低级联赛锻炼一年等原因，合同停滞在2012/13年，大概有一百多位这样的球员。</p>
<p><img src="/img/basketball-reference-2.png" alt="basketball-reference-2"></p>
<h3 id="-">将抓取的表数据格式化</h3>
<p>我不知道python的scrapy或者beautifulsoup是什么样，R抓取的网页数据，如果想拿来做数据分析，似乎都要这个过程，把抓下来的html节点，<code>as.numeric(as.character())</code>一下，不知道有木有更简便的方法啊？</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre>data_player_all_full = as.data.frame(data_player_all[<span class="number">1</span>])
<span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">2</span>:length(data_player_all)){
  tmp = as.data.frame(data_player_all[i])
  names(data_player_all_full) = names(tmp)
  data_player_all_full = rbind(data_player_all_full, tmp)
}

names(data_player_all_full) = c(<span class="string">"player"</span>,<span class="string">"from"</span>,<span class="string">"to"</span>,<span class="string">"position"</span>,<span class="string">"height"</span>,<span class="string">"weight"</span>,<span class="string">"birthdate"</span>,<span class="string">"college"</span>)
data_player_all_full$from = as.numeric(as.character(data_player_all_full$from))
data_player_all_full$to = as.numeric(as.character(data_player_all_full$to))
data_player_all_full$weight = as.numeric(as.character(data_player_all_full$weight))
data_player_all_full$height = sapply(data_player_all_full$height, FUN=<span class="keyword">function</span>(x) sub(<span class="string">"-"</span>,<span class="string">"."</span>,x))
data_player_all_full$height = as.numeric(as.character(data_player_all_full$height))
</pre></td></tr></table></figure>

<p>这一段纯粹为了擦屁股，但为了能分析数据，也是很至关重要的。</p>
<h3 id="-nba-">哪个星座的NBA球员最多？</h3>
<p>知道我有多无聊了吧。数据里的出生日期是英文格式，所以又需要把它转成数字格式，我没找到有函数可以方便的转换，应该没有这么智能的，于是还是手动转吧。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre>from = c(<span class="string">'January'</span>,<span class="string">'February'</span>,<span class="string">'March'</span>,<span class="string">'April'</span>,<span class="string">'May'</span>,<span class="string">'June'</span>,
         <span class="string">'July'</span>,<span class="string">'August'</span>,<span class="string">'September'</span>,<span class="string">'October'</span>,<span class="string">'November'</span>,<span class="string">'December'</span>,<span class="string">','</span>,<span class="string">' '</span>)
to = c(<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,<span class="string">'10'</span>,<span class="string">'11'</span>,<span class="string">'12'</span>,<span class="string">''</span>,<span class="string">'/'</span>)
gsub2 = <span class="keyword">function</span>(pattern, replacement,x,<span class="keyword">...</span>){
  <span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1</span>:length(pattern))
    x = gsub(pattern[i],replacement[i],x,<span class="keyword">...</span>)
  x
}

data_player_all_full$birthdate = gsub2(from, to, data_player_all_full$birthdate)
data_player_all_full[data_player_all_full$birthdate == <span class="string">""</span>,]$birthdate = <span class="string">"00/00/0000"</span>
</pre></td></tr></table></figure>

<p>转完之后，再把mm/dd/yyyy格式的日期，分割成三列，用来根据月份和日期判断星座。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="code"><pre>c= do.call(rbind.data.frame, strsplit(data_player_all_full$birthdate,<span class="string">"/"</span>))
names(c) = c(<span class="string">'birthmonth'</span>,<span class="string">'birthday'</span>,<span class="string">'birthyear'</span>)
c$birthmonth = as.numeric(as.character(c$birthmonth))
c$birthday = as.numeric(as.character(c$birthday))
c$birthyear = as.numeric(as.character(c$birthyear))
data_player_all_full = cbind(data_player_all_full,c)

constellation = <span class="keyword">function</span>(x,y){
  <span class="keyword">if</span>(x == <span class="number">3</span> & y &gt;= <span class="number">21</span>) <span class="keyword">return</span>(<span class="string">"Aries"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">4</span> & y &lt;= <span class="number">19</span>) <span class="keyword">return</span>(<span class="string">"Aries"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">4</span> & y &gt;= <span class="number">20</span>) <span class="keyword">return</span>(<span class="string">"Taurus"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">5</span> & y &lt;= <span class="number">20</span>) <span class="keyword">return</span>(<span class="string">"Taurus"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">5</span> & y &gt;= <span class="number">21</span>) <span class="keyword">return</span>(<span class="string">"Gemini"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">6</span> & y &lt;= <span class="number">21</span>) <span class="keyword">return</span>(<span class="string">"Gemini"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">6</span> & y &gt;= <span class="number">22</span>) <span class="keyword">return</span>(<span class="string">"Cancer"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">7</span> & y &lt;= <span class="number">22</span>) <span class="keyword">return</span>(<span class="string">"Cancer"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">7</span> & y &gt;= <span class="number">23</span>) <span class="keyword">return</span>(<span class="string">"Leo"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">8</span> & y &lt;= <span class="number">22</span>) <span class="keyword">return</span>(<span class="string">"Leo"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">8</span> & y &gt;= <span class="number">23</span>) <span class="keyword">return</span>(<span class="string">"Virgo"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">9</span> & y &lt;= <span class="number">22</span>) <span class="keyword">return</span>(<span class="string">"Virgo"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">9</span> & y &gt;= <span class="number">23</span>) <span class="keyword">return</span>(<span class="string">"Libra"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">10</span>& y &lt;= <span class="number">23</span>) <span class="keyword">return</span>(<span class="string">"Libra"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">10</span>& y &gt;= <span class="number">24</span>) <span class="keyword">return</span>(<span class="string">"Scorpio"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">11</span>& y &lt;= <span class="number">21</span>) <span class="keyword">return</span>(<span class="string">"Scorpio"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">11</span>& y &gt;= <span class="number">22</span>) <span class="keyword">return</span>(<span class="string">"Sagittarius"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">12</span>& y &lt;= <span class="number">21</span>) <span class="keyword">return</span>(<span class="string">"Sagittarius"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x == <span class="number">12</span>& y &gt;= <span class="number">22</span>) <span class="keyword">return</span>(<span class="string">"Capricorn"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x ==  <span class="number">1</span>& y &lt;= <span class="number">19</span>) <span class="keyword">return</span>(<span class="string">"Capricorn"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x ==  <span class="number">1</span>& y &gt;= <span class="number">20</span>) <span class="keyword">return</span>(<span class="string">"Aquarius"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x ==  <span class="number">2</span>& y &lt;= <span class="number">18</span>) <span class="keyword">return</span>(<span class="string">"Aquarius"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x ==  <span class="number">2</span>& y &gt;= <span class="number">19</span>) <span class="keyword">return</span>(<span class="string">"Pisces"</span>) <span class="keyword">else</span>
  <span class="keyword">if</span>(x ==  <span class="number">3</span>& y &lt;= <span class="number">20</span>) <span class="keyword">return</span>(<span class="string">"Pisces"</span>) <span class="keyword">else</span> <span class="keyword">return</span>(<span class="string">"Alien"</span>)
}

<span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1</span>:length(data_player_all_full$birthmonth)) {
  data_player_all_full$constellation[i] = constellation(data_player_all_full$birthmonth[i],
  data_player_all_full$birthday[i])
}
</pre></td></tr></table></figure>

<p>好了，就这样。其实想想，应该可以直接通过字符串语句的来判断星座的，必须得有更好的方法。</p>
<p>先做个简单的统计图，看看哪个星座的NBA球员最多。</p>
<p><img src="/img/NBA-constellation.png" alt="NBA-constellation"></p>
<p>看来处女座的NBA球员最多，而摩羯座的最少啊，不过差别不多啦。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/菜鸟学R语言/" term="菜鸟学R语言"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[可以去河里采样了吗？]]></title>
    <link href="http://yangliufr.com/2014/01/09/when-to-sample-in-fileds-use-r-parse-water-level/"/>
    <id>http://yangliufr.com/2014/01/09/when-to-sample-in-fileds-use-r-parse-water-level/</id>
    <published>2014-01-09T00:00:00.000Z</published>
    <updated>2014-01-14T13:49:37.000Z</updated>
    <content type="html"><![CDATA[<p>新学期开始啦！第一篇论文终于写完了，导师和我已经改了无数遍，基本定稿了，正在等待其他作者通读一遍，认为没问题就要投了。下面的任务就是开始新的实验，我需要去加龙河的河床上去采样，生物膜、河水、底泥啥的。但如果水位超过一定程度，就不安全，我们就要等水位降下来，才再跟司机约时间去。</p>
<a id="more"></a>

<p>法国政府网站上有各个水文站公布的数据的，我们一般打开网站看看水位超过0.8m没有，就可以决定要不要去了。</p>
<p><img src="/img/Garonne-water-level.png" alt="Garonne water level from France goverment"></p>
<p>网站上也很贴心的给出了表格数据，每天、每三天和每七天的数据，看到table，我就想抓。于是就写了个非常简单的脚本。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="keyword">library</span>(XML)

station_url = <span class="string">"http://www.vigicrues.gouv.fr/niveau3.php?idstation=1818&typegraphe=h&AffProfondeur=24&nbrstations=5&ong=2&Submit=Refaire+le+tableau+-+Valider+la+s%C3%A9lection"</span> <span class="comment">#the site we care about</span>
table_station_url = as.data.frame(readHTMLTable(station_url)[<span class="number">1</span>])
table_station_url[,<span class="number">2</span>] = as.numeric(as.character(table_station_url[,<span class="number">2</span>]))
<span class="keyword">if</span>(mean(table_station_url[,<span class="number">2</span>]) &gt;= <span class="number">0.8</span>){
  print(<span class="string">"No way! It's dangerous!"</span>)
  <span class="keyword">else</span>{
    print(<span class="string">"Yeah! It's ready to go!!"</span>)
  }
}
</pre></td></tr></table></figure>

<p>每天在R里面运行一下这个脚本即可。其实，这有点画蛇添足，因为从实用角度讲，我其实点一下网页也能知道能不能去的。说白了，就是闲的。</p>
<p>题外话，最近在学python，从头学，因为我还挺喜欢抓取网站数据的。有国内同学想做奢侈品代购，我也写了个R脚本，抓取prada官网的价格和有无存货（里面对我来说，稍微有点技术含量的就是，找到了个有规律的json地址，于是存货与否就搞定了）。但这都只是凤毛麟角，要抓取不学python怎么行？</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/菜鸟学R语言/" term="菜鸟学R语言"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[如何用zotero在论文中引用R]]></title>
    <link href="http://yangliufr.com/2013/12/05/how-to-cite-r-in-your-paper-or-publication/"/>
    <id>http://yangliufr.com/2013/12/05/how-to-cite-r-in-your-paper-or-publication/</id>
    <published>2013-12-05T00:00:00.000Z</published>
    <updated>2014-01-18T17:37:39.000Z</updated>
    <content type="html"><![CDATA[<p>一些题外话：</p>
<p>之前的<a href="http://yangliufr.com/2013/04/03/zotero-1/">zotero教程</a>没能继续下去，因为我没什么信心去改变用户习惯，例如很多人写论文插入引文时，还会手写插入而不愿意去用文献管理软件。可能是我想太多了。</p>
<p>后来有一阵子直到前几天，我为了能让PC端和iPad上能够云端同步，方便在iPad上阅读，查阅了很多文章资料，包括<a href="http://www.infotech.ac.cn/fileup/PDF/20120915.pdf‎" target="_blank">这篇难得的对口味的中文文献</a>，给了我很大帮助。最终，我选择了EndNote，并在淘宝上买了所谓的付费版。如果你手中也有iPad，也希望用她来作为你的科研生产力工具的话，我仍推荐你用EndNote，至于今天为什么我用回zotero，那是后话了。</p>
<a id="more"></a>

<h3 id="-r-">为什么要在论文里引用R？</h3>
<p>很简单，因为我用R来做数据分析和作图。</p>
<h3 id="-">怎么引用呢？</h3>
<p>本文所有内容对于那些手动插入引文的同学是毫无意义的。仅针对使用文献管理软件的同学，让你的文献库里面有R的身影。</p>
<p>其实这个问题，R早就想过，估计用latex和knitr写论文的同学直接在R中使用<code>citation()</code>即可，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre>&gt; citation()

To cite R <span class="keyword">in</span> publications use:

  R Core Team (<span class="number">2013</span>). R: A language and environment <span class="keyword">for</span> statistical computing. R Foundation <span class="keyword">for</span> Statistical
  Computing, Vienna, Austria. URL http://www.R-project.org/.

A BibTeX entry <span class="keyword">for</span> LaTeX users is

  @Manual{,
    title = {R: A Language and Environment <span class="keyword">for</span> Statistical Computing},
    author = {R Core Team},
    organization = {R Foundation <span class="keyword">for</span> Statistical Computing},
    address = {Vienna, Austria},
    year = {<span class="number">2013</span>},
    url = {http://www.R-project.org/},
  }

We have invested a lot of time and effort <span class="keyword">in</span> creating R, please cite it when using it <span class="keyword">for</span> data analysis. See
also ‘citation(<span class="string">"pkgname"</span>)’ <span class="keyword">for</span> citing R packages.
</pre></td></tr></table></figure>

<p>接下来，要稍微修改一下上面这段代码，把<code>organization</code>改为<code>publisher</code>（否则，zotero不识别原本organization的信息）。即，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre>  @Manual{,
    title = {R: A Language and Environment <span class="keyword">for</span> Statistical Computing},
    author = {R Core Team},
    publisher = {R Foundation <span class="keyword">for</span> Statistical Computing},
    address = {Vienna, Austria},
    year = {<span class="number">2013</span>},
    url = {http://www.R-project.org/},
  }
</pre></td></tr></table></figure>

<p>然后，ctrl+C 拷贝全部即可，这也许就是zotero神奇的地方，然后打开zotero，点击齿轮图标，选择“从粘贴板导入（import from clipboard）”，如下图，</p>
<p><img src="/img/zotero-r-1.png" alt="clipboard"></p>
<p>这样就成功创建了一个引文记录，但是，还没有完全成功，因为此时在“作者（author）”一栏是有问题的，zotero或者EndNote都会自动把作者识别为Team R.Core，即Team是名，R.Core是姓。这时，就只能手动修改，让她有名无姓即可，即把R Core Team放在作者栏的第一格，并在末尾添加一个逗号“,”，如下图所示，</p>
<p><img src="/img/zotero-r-2.png" alt="author"></p>
<p>这样就可以放心插入到文章中了。</p>
<p>如果不手动修改作者那一栏，所出现的问题，如下所示，给出了错误与正确的引用方式：</p>
<p><img src="/img/zotero-r-3.png" alt="citation"></p>
<p>好了，这样就完成了，看似很麻烦，要有三步才能完成，但也是一劳永逸的事情。如果引用某个R package的时候，是非常方便的，可以省去以上的两个步骤，只需要在R中执行代码<code>citation(&quot;name&quot;)</code>，然后复制整段的结果即可，不需要做任何修改，因为开发R包的都是有名有姓的人物。当然，这些信息也可以全部手动输入到zotero或者EndNote里面，只要新建一个空白引文即可，as you want.</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/菜鸟学R语言/" term="菜鸟学R语言"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[我印象中的韩国：参加国际小型底栖生物会议有感]]></title>
    <link href="http://yangliufr.com/2013/10/04/my-view-of-south-korea/"/>
    <id>http://yangliufr.com/2013/10/04/my-view-of-south-korea/</id>
    <published>2013-10-04T07:16:02.000Z</published>
    <updated>2013-10-05T05:30:56.000Z</updated>
    <content type="html"><![CDATA[<p>七月下旬去的韩国首尔参加学术会议，一直没有写点啥。最近，因为广州恒大队要在亚冠决赛中与首尔FC队交锋，看到对方主教练的挑衅言论和韩国媒体的一些报道，才想起来这个国家我去过。那就说说我的感受吧。</p>
<a id="more"></a>

<h3 id="-">空姐</h3>
<p>飞机上我坐最后一排，后面就是空姐坐的位置和备餐间了。那位空姐长得跟金喜善差不多，我也不知道是整容还是怎么的，典型的韩国广告中的女明星模样，当然，服务还是很到位的，即便是旁边一堆不太听话的上海旅游团大妈，她还是微笑服务。关于上海大妈我就不吐槽了，毕竟今天是说韩国。</p>
<h3 id="-">仁川机场</h3>
<p>仁川机场相比浦东机场，从我个人感受上小一些，跟图卢兹的差不多。因为不需要走太多的路，过了海关出来走不了多远就到了乘坐大巴的地方了。对，只有大巴，没有地铁站在仁川机场。大巴很准时，座位很宽敞，很舒服，韩国大宇汽车嘛。只坐了三个人司机到点就开车了。</p>
<h3 id="-">中国人聚集地</h3>
<p>因为我去开会的学校是汉阳大学（Hanyang University），不在首尔市区，在一个叫安山的地方，类似于北京通县或上海松江或南京仙林之类的，所以我要转地铁和公交。地铁售票机有韩语、英语和中文的界面和操作提示，我还觉得这挺好。可以买完票就傻了，地铁开车方向的提示牌上只有韩文，我就不知道怎么坐了。情急之下，我就找了一个面善的男生用英语问了下我要去安山坐哪个方向的地铁，他似乎听不懂，我给他看我iPad里面的英文地铁路线图，他似乎懂了，招呼我一起上车，并用蹩脚的英文说他也要去那。</p>
<p>在地铁上，我继续问，并拿出组委会给我的宾馆地址给他看，想着这韩文的东西你总能看懂了吧。没想到他还是看不懂，憋了半天看懂了biology的韩语。我就纳闷了，我不会被卖了吧，这地儿也太偏了，韩国人都不知道在哪儿。</p>
<p>情急之下，这位“韩国友人”掏出了iPhone，想看下他存的地铁路线图，我想也对，韩国人看英文不一定方便，看他韩文的地铁图吧。没想到，手机界面是中文，我想，这哥们在学中文吗？因为以前我也装逼把手机界面调成英文来着。然后我就用英文问他说“你在学中文吗，我是中国人”，他似乎终于挺懂我的一整句英语了，并且用很纯正的东北口音回答我，我也是中国人。</p>
<blockquote>
<p>holy moley christ jesus</p>
</blockquote>
<p>我内心的OS就是这样。闹了半天两个中国人在韩国用英语交谈了半天。他告诉我，在我上地铁的那个地方，很多中国人开的店，周围也住着很多中国人，你随便找个人问路，肯定能找到中国人。后来他还帮了我很大的忙，借给我手机给组织者打电话，因为已经晚上9点多，我只好打车过去。走得急，只说了谢谢却没有留联系方式，我相信好人肯定有好报的。</p>
<h3 id="-">入住</h3>
<p>然后我就到了学校的宾馆，通过话的那个负责人是个刚上博一的韩国学生，英语很不错，也是美式口音。最后安顿在了他们学生宿舍，有十几层的一栋楼，很大很大，男女生分别在两边，一楼中间有食堂、7-11等，很方便了。宿舍是两人间的，我一个人住，有空调，相当于宾馆的标间了，条件很不错。网速超快的，要知道用的是免费wifi。迅雷离线下了不少东西。然后就等着第二天开会了。</p>
<h3 id="-">会议过程</h3>
<p>本来在出发前发邮件安排我在会议第四天讲，但是，开会第一天发下来的安排表，把我们这个section调到了第二天。演讲过程很顺利，会后受到几位老师的好评，当然就当做客套话来听就好。国立台湾海洋大学的一位老师还问我是不是在美国待过，又不小心把我的美国梦点燃了起来。</p>
<p>整个会议流程下来，我是唯一一个来自法国的代表，因为年初注册的时候，很多欧洲的老师怕南北朝会有战争的风险，没有报名参加。顿时觉得，他们真会为经济危机找借口。</p>
<p>此外，由于我以前毕业院校非一流，在会议后的聚餐会上，我主动跟国内海大和厦大的团队问好，他们说已经注意到我的名字，以为有可能是什么华侨之类。谈话间，还是感受得到他们对于在本学科发展的同学的关怀和鼓励，并希望能够有人能够做得好。其实，对我也算是一针强心剂受益匪浅。另外，来自厦大的蔡教授对我更是关爱有加，希望以后能有机会合作。</p>
<p>会后，得了个奖，250美元，作为travel support。我很果断的要了欧元，折合190欧元，回到家，关上门，暗地里用人民币做中间币种算了下，赚了15块哎！果然，还是没摆脱250的束缚。</p>
<h3 id="-">汉阳大学</h3>
<p>我很惊讶在汉阳大学，已经有很多外籍教授在此执教了，而且都是底栖生物无脊椎动物这一块的老师，在会议上出现的有四五位老师吧。我不知道是不是类似于国内的千人计划还是什么。就在这个学科来讲，因为大类属于生态学，没有直接的经济效益，而且也牵扯到出海采样等，需要大量资金的，居然可以引进数位外籍教师。我觉得，挂名与否已经不重要了。因为，这次国际会议是三年一届，已经召开了14届，这次第15届是第一次在亚洲举办。汉阳大学能有这个实力承办，已经说明他们有足够的学术基础。</p>
<p>而且，从他们这几年做的项目成果可以看到，他们做的非常好。虽然大部分都是基础性的对韩国海岸线上小型底栖生物的调查性研究，但这正是考验学科功底深厚与否的最好验证，前面说了，这些基础性调查研究和分子生物学研究的重要性同样重要，因为在其他学科同学看来，影响因子高的文章就牛逼，低的就不行。有时，其实更多时候，要看你这个学科，甚至你这个研究方向的平均水准，不能一概而论。</p>
<p>所以，我对这个学校的印象非常好，很扎实。底栖生物，尤其实效性底栖生物，无论在国外还是国内，做的人都相对较少，欧洲最多，美国其次，亚洲在这方面尤为缺乏。因为是底栖生物，又分大型和小型，一般来说，研究大型的多，笼统的相对来讲，大型的见效快。所以，亚洲发展中国家较多的情况下，资金相对不足，研究小型底栖生物的课题组就相对较少。不说能像汉阳大学这样的，国内所有在做的一双手是能数的过来的，当然国内个别大学的实力是高于汉阳大学的，例如第17届该会议的举办单位中国海洋大学。</p>
<h3 id="-">总体印象</h3>
<p>发达国家就是发达国家。跟法国都是法国车一样，首尔的公路上大多是韩国车，而且司机和行人的素质都很高，过马路的习惯很好，司机也不抢道。顿时觉得，这对于习惯在欧洲生活的人来到这里，除了语言和食物，没有太多的生活习惯差异。文化这个东西很难定义，主要看个人的生活习惯。一般大城市来说，大差不差了。因为毕竟过圣诞还是农历新年，差别并不大，过马路或者开车，这都是每天都要遇到的，差异化感受会更切身。</p>
<p>唯一不满意的就是食物了，在学校食堂，条件也不错，就是整天泡菜，而且没有什么花样的蔬菜，除了白菜就是胡萝卜，肉类也少的可怜。同样是食堂，我们图卢兹三大的食堂都要好很多很多。不过一想，国际五大菜系里面有中国和法国的名字，哪儿轮得到韩国，无论他们有多想加入进来。</p>
<p>还有，欧洲一体化的进程已经很深入了，以前的关注点都在欧美。这次在首尔，感受到中日韩这东亚三国，必须团结起来，化解矛盾，多交流，才能共同进步。民间的交流有很多了，超出了我的刻板印象。可能以前总是盲目崇拜欧美吧，对亚洲尤其东亚文化圈的关注很少，即便有也没有如此切身的体会。同样的语言不通，法国和德国，以及其他说法语和德语的国家，总有很多交流的机会和绿色通道。相信韩国、日本与中国的交流也有不少，只是以前真没从这方面多想过。同样是三种很不一样却又有些渊源的语言，中文、日文、韩文，如果日本当年没有侵略韩国、中国，如果韩国不去到处申请中国的文化遗产，我想，东亚已经一定是世界经济文化的另一个共同体。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/一些思考/" term="一些思考"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[菜鸟学R语言：用R做数据分析（零基础）之数据类型]]></title>
    <link href="http://yangliufr.com/2013/09/29/r-introduction-i/"/>
    <id>http://yangliufr.com/2013/09/29/r-introduction-i/</id>
    <published>2013-09-29T21:52:40.000Z</published>
    <updated>2013-10-02T13:15:09.000Z</updated>
    <content type="html"><![CDATA[<p>接着<a href="http://yangliufr.com/2013/09/24/r-introduction/">上一篇</a>来介绍。第一周课的内容还没有总结完，争取有所收获。关于如何安装R以及可选安装的RStudio等，这里不做介绍了。市面上有很多中英文教材了，我也是看着那些教材教程过来的，网络上的资源更是丰富，我遇到的很多偏门的问题都可以搜索到，所以我只是在踏着前辈们走过的路再走一遍而已。我写这个教程的目的：</p>
<ol>
<li>为上课做好笔记</li>
<li>梳理R相关的基础知识</li>
<li>分享自己的学习心得体会</li>
<li>与其他初学者一起交流<a id="more"></a>

</li>
</ol>
<hr>
<h2 id="r-">R 基础知识</h2>
<h3 id="-">四则运算</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="comment"># Basic mathematical operations</span>
<span class="number">3</span> + <span class="number">4</span>
<span class="number">5</span> * <span class="number">5</span>
<span class="number">12</span> / <span class="number">3</span>
<span class="number">5</span>^<span class="number">5</span>
</pre></td></tr></table></figure>

<p>这几行代码就充分展现出了R的优势之一，<strong>即时互动</strong>。大家只要在console中输入以上一行代码，就可以直接得到结果，省去了传统语言编译的过程（并不是说R中不存在编译）。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre>&gt; <span class="number">3</span> + <span class="number">4</span>
[<span class="number">1</span>] <span class="number">7</span>
&gt; <span class="number">5</span> * <span class="number">5</span>
[<span class="number">1</span>] <span class="number">25</span>
&gt; <span class="number">12</span> / <span class="number">3</span>
[<span class="number">1</span>] <span class="number">4</span>
&gt; <span class="number">5</span>^<span class="number">5</span>
[<span class="number">1</span>] <span class="number">3125</span>
</pre></td></tr></table></figure>

<p>以上就是运行结果。</p>
<hr>
<h2 id="r-object-r-">R object (R 的对象)</h2>
<h3 id="vector-">vector (向量)</h3>
<p>向量（<code>vector</code>）是R中最基本的对象。R的对象中大部分能且只能包含同一类的若干个元素，但是<code>list</code>除外，可以包含若干类的若干个元素，这也是为什么要有<code>list</code>的原因。常见的向量有：</p>
<ul>
<li>字符向量</li>
<li>数值向量</li>
<li>整数向量</li>
<li>复数向量</li>
<li>逻辑向量</li>
</ul>
<p>下面来创建一个含有数值1,3,5,7的向量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>&gt; v &lt;- c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>) <span class="comment">#c() 是combine，集合的意思</span>
&gt; x &lt;- c(<span class="number">0.5</span>, <span class="number">0.6</span>) <span class="comment">## numeric</span>
&gt; x &lt;- c(<span class="literal">TRUE</span>, <span class="literal">FALSE</span>) <span class="comment">## logical</span>
&gt; x &lt;- c(<span class="literal">T</span>, <span class="literal">F</span>) <span class="comment">## logical</span>
&gt; x &lt;- c(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>) <span class="comment">## character</span>
&gt; x &lt;- <span class="number">9</span>:<span class="number">29</span> <span class="comment">## integer</span>
&gt; x &lt;- c(<span class="number">1</span>+<span class="number">0i</span>, <span class="number">2</span>+<span class="number">4i</span>) <span class="comment">## complex</span>
</pre></td></tr></table></figure>

<p>但，如果把两种向量<code>c()</code>到一起，会得到什么样的向量集合呢？</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>&gt; y &lt;- c(<span class="number">1.7</span>, <span class="string">"a"</span>) <span class="comment">## character</span>
&gt; y &lt;- c(<span class="literal">TRUE</span>, <span class="number">2</span>) <span class="comment">## numeric</span>
&gt; y &lt;- c(<span class="string">"a"</span>, <span class="literal">TRUE</span>) <span class="comment">## character</span>
</pre></td></tr></table></figure>

<p>你会发现，这时向量集会被强制（coercion）转成同一类，为了符合向量的定义。这时，如果你需要提取其中的<strong>假向量</strong>用于运算，那就需要<code>as.**</code>functions，其中<code>**</code>可以是<code>numeric``logical``character``complex</code>等。如下，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre>&gt; x &lt;- <span class="number">0</span>:<span class="number">6</span>
&gt; class(x) <span class="comment">#class()用于查看向量的类</span>
[<span class="number">1</span>] <span class="string">"integer"</span>
&gt; as.numeric(x)
[<span class="number">1</span>] <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span>
&gt; as.logical(x)
[<span class="number">1</span>] <span class="literal">FALSE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span>
&gt; as.character(x)
[<span class="number">1</span>] <span class="string">"0"</span> <span class="string">"1"</span> <span class="string">"2"</span> <span class="string">"3"</span> <span class="string">"4"</span> <span class="string">"5"</span> <span class="string">"6"</span>
&gt; as.complex(x)
[<span class="number">1</span>] <span class="number">0</span>+<span class="number">0i</span> <span class="number">1</span>+<span class="number">0i</span> <span class="number">2</span>+<span class="number">0i</span> <span class="number">3</span>+<span class="number">0i</span> <span class="number">4</span>+<span class="number">0i</span> <span class="number">5</span>+<span class="number">0i</span> <span class="number">6</span>+<span class="number">0i</span>
</pre></td></tr></table></figure>

<p>如果使用<code>as.**</code>function把某类向量转化为另一类，则会得到<code>NA</code>s。如，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>&gt; x &lt;- c(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>)
&gt; as.numeric(x)
[<span class="number">1</span>] <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span>
Warning message:
NAs introduced by coercion
&gt; as.logical(x)
[<span class="number">1</span>] <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span>
</pre></td></tr></table></figure>

<p>有时你可能还需要空白向量，可以用<code>vector()</code>来创建，例如创建一个长度为10的数值向量<code>x</code>，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>&gt; x &lt;- vector(<span class="string">"numeric"</span>, length = <span class="number">10</span>)
&gt; x
[<span class="number">1</span>] <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>
</pre></td></tr></table></figure>

<hr>
<h3 id="matrix-">matrix （矩阵）</h3>
<p>矩阵（pl. matrices）具有维度（dimension）属性（attribute）的向量。该维度属性本身是一个长度为2的整数向量（nrow,ncol），行数和列数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre>&gt; m &lt;- matrix(nrow = <span class="number">2</span>, ncol = <span class="number">3</span>)
&gt; m
[,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]
[<span class="number">1</span>,] <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span>
[<span class="number">2</span>,] <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span>
&gt; dim(m)
[<span class="number">1</span>] <span class="number">2</span> <span class="number">3</span>
&gt; attributes(m)
$dim
[<span class="number">1</span>] <span class="number">2</span> <span class="number">3</span>
</pre></td></tr></table></figure>

<p>在R中建矩阵是遵从<strong>列优先（column-wise）</strong>的原则，即，优先按照顺序从左上角开始向右一列一列地填充。如，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>&gt; m &lt;- matrix(<span class="number">1</span>:<span class="number">6</span>, nrow = <span class="number">2</span>, ncol = <span class="number">3</span>)
&gt; m
[,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]
[<span class="number">1</span>,] <span class="number">1</span> <span class="number">3</span> <span class="number">5</span>
[<span class="number">2</span>,] <span class="number">2</span> <span class="number">4</span> <span class="number">6</span>
</pre></td></tr></table></figure>

<p>在了解了这个特性之后，我们就可使用<code>dim()</code>来为向量集创建矩阵了，大家只要注意<strong>列优先</strong>原则即可，如，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre>&gt; m &lt;- <span class="number">1</span>:<span class="number">10</span>
&gt; m
[<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span> <span class="number">10</span>
&gt; dim(m) &lt;- c(<span class="number">2</span>, <span class="number">5</span>)
&gt; m
[,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>] [,<span class="number">5</span>]
[<span class="number">1</span>,] <span class="number">1</span> <span class="number">3</span> <span class="number">5</span> <span class="number">7</span> <span class="number">9</span>
[<span class="number">2</span>,] <span class="number">2</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">10</span>
</pre></td></tr></table></figure>

<p>此外，在R中，你也可以使用<code>cbind()</code>（column-binding）和<code>rbind()</code>（row-binding）functions来创建矩阵。如，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre>&gt; x &lt;- <span class="number">1</span>:<span class="number">3</span>
&gt; y &lt;- <span class="number">10</span>:<span class="number">12</span>
&gt; cbind(x, y)
x y
[<span class="number">1</span>,] <span class="number">1</span> <span class="number">10</span>
[<span class="number">2</span>,] <span class="number">2</span> <span class="number">11</span>
[<span class="number">3</span>,] <span class="number">3</span> <span class="number">12</span>
&gt; rbind(x, y)
[,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]
x <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>
y <span class="number">10</span> <span class="number">11</span> <span class="number">12</span>
</pre></td></tr></table></figure>

<p>好了，今天就到这里吧，可能这种方式对那些以结果为导向的初学者来说，进度太慢，而且枯燥乏味吧。但是，我想对于想要学好R的零基础同学来说，这样会给大家一个更全面完整的认识吧。我个人认为，还是好好了解这些基础知识更好点，因为我之前就是结果导向，有时为了除bug，会耗费很长时间，其实就是类似的对<strong>对象</strong>、<strong>向量</strong>等基础知识一知半解造成的。如今，返回来再看这个会给自己建立一个体系，饶有趣味。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/菜鸟学R语言/" term="菜鸟学R语言"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[菜鸟学R语言：用R做数据分析（零基础）之前言]]></title>
    <link href="http://yangliufr.com/2013/09/24/r-introduction/"/>
    <id>http://yangliufr.com/2013/09/24/r-introduction/</id>
    <published>2013-09-24T21:13:40.000Z</published>
    <updated>2013-10-02T13:08:58.000Z</updated>
    <content type="html"><![CDATA[<p><em>最近在上<a href="http://coursera.org" target="_blank">coursera</a>的课，九月初的时候选了几门，现在陆续开课了。因为第一年自学数据分析和R收效甚微，想系统的学学，于是选了Statistics One （12周）和 Computing for Data Analysis （4周）。我会陆续分享我学到的知识和感想。</em>
<a id="more"></a></p>
<hr>
<h2 id="-">前言</h2>
<blockquote>
<p>What makes R different?</p>
</blockquote>
<p>约翰·霍普金斯大学的华裔老师Roger Peng（Computing for Data Analysis的授课人）就以这个标题开篇。我觉得挺有必要理理清楚的，之前在统计之都和谢益辉的博客中看到过类似的讨论，由于我还是个门外汉，对于行内人的讨论只能看个热闹。这次Roger的解释面向的都是零基础学生，所以，这种解释可能更适合菜鸟来看。</p>
<p>Roger提到，在数据分析或统计分析的世界中，常用的工具软件可以大致分为三类，</p>
<ol>
<li>经典的命令行，人机互动界面。在对话窗口中敲命令，回车，得到个返回值，然后再敲命令，回车，又得到个返回值。</li>
<li>传统的编程语言，如C,C++,Perl和Python等。虽然和1.相仿，都是写代码，但是1.是输入命令，出结果，而这些传统编程语言则是要写好整个程序，不光光是用于运算的那些命令。所以这类语言不具备<strong>即时互动</strong>的特点。</li>
<li>可视化操作界面，微软的Excel等。鼠标动动点点即可，不涉及到真正的计算机语言和编程。</li>
</ol>
<p>而R语言，则是整合了命令行窗口和编程语言界面的一种特殊的语言。有人认为，这有什么好的，让我选肯定选择有可视化界面的软件。但Roger认为，恰恰是具备前两种特点，才让R独树一帜。有传统编程语言知识的同学，和习惯与SAS或STATA的命令行操作打交道的同学都可以在R中找到自己熟悉上手的地方。也正因为R整合了这两种方式，对于菜鸟或者新手来说，可以先<strong>从命令行模式入门</strong>，利用其即时互动的模式，通过输入命令，快速得到自己想要的统计结果，随着你学习的深入，需求的增长，你可利用学过的传统编程语言知识，自己写一个满足自己需求的软件包。最终，集思广益，R软件包的功能一定会非常强大，当然目前已经非常强大了。</p>
<p>所以，不像Excel功能相对单一，很难跟上数据统计分析的快速增长的需求，也不像Python那样入门门槛较高，需要接触到很多与数据统计分析无关的知识。R的这种由浅入深，可谓深得人心。</p>
<p>下面贴出普林斯顿大学Andrew Conway老师在<a href="https://class.coursera.org/stats1-002/lecture/index" target="_blank">Statistics One</a>课程中提供的Introduction to R的入门脚本。我保留了英文原文的注释，因为对于新手来说，直接学习英文资料要来的更纯，很多<code>function</code>名记起来会更直接。下一篇，我再详细介绍一下以下这些功能。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
</pre></td><td class="code"><pre><span class="comment"># Basic mathematical operations</span>
<span class="number">3</span> + <span class="number">4</span>
<span class="number">5</span> * <span class="number">5</span>
<span class="number">12</span> / <span class="number">3</span>
<span class="number">5</span>^<span class="number">5</span>

<span class="comment"># R objects</span>

<span class="comment"># Vector </span>
<span class="comment">## Most basic object in R </span>
<span class="comment">## Contains elements of the same class</span>
<span class="comment">## Can be: character, numeric, integer, complex, logical(True/False))</span>

<span class="comment"># Create a vector</span>
v=c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>)
v

<span class="comment"># List </span>
<span class="comment">## (Vector with different class of objects) </span>
l=list(<span class="string">"Blue"</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="string">"Red"</span>)
l

<span class="comment"># Create a matrix</span>
m=matrix(<span class="number">1</span>:<span class="number">6</span>,<span class="number">2</span>,<span class="number">3</span>)
m
<span class="comment">## Matrix creation is column-wise</span>

<span class="comment"># Create a matrix from a vector</span>
m2=matrix(<span class="number">1</span>:<span class="number">6</span>)
<span class="comment"># Then add dimensionality</span>
dim(m2)=c(<span class="number">2</span>,<span class="number">3</span>)
m2

<span class="comment"># Create a matrix by binding columns or rows</span>
x=<span class="number">1</span>:<span class="number">6</span>
y=<span class="number">5</span>:<span class="number">10</span>
cbind(x,y) <span class="comment"># by column</span>
rbind(x,y) <span class="comment"># by row</span>

<span class="comment"># Check the attributes</span>
attributes(m)

<span class="comment"># Call a particular cell in a matrix</span>
m
m[<span class="number">1</span>,<span class="number">2</span>]

<span class="comment"># Dataframes</span>
<span class="comment">## Different than matrices =&gt; can store different classes of objects</span>
<span class="comment">## Usually called with read.table()</span>

<span class="comment"># Create a dataframe</span>
d=data.frame(subjectID=<span class="number">1</span>:<span class="number">5</span>,gender=c(<span class="string">"M"</span>,<span class="string">"F"</span>,<span class="string">"F"</span>,<span class="string">"M"</span>,<span class="string">"F"</span>),score=c(<span class="number">8</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">5</span>))
d

<span class="comment"># Number of rows</span>
nrow(d)

<span class="comment"># Number of columns</span>
ncol(d)

<span class="comment"># Check the attributes</span>
attributes(d)

<span class="comment"># Call a particular cell in a dataframe</span>
d[<span class="number">2</span>,<span class="number">1</span>]
d[<span class="number">1</span>,<span class="number">2</span>]

<span class="comment"># Display dataframe</span>
View(d)
<span class="comment"># Edit dataframe</span>
edit(d)

<span class="comment"># Getting help on a function</span>
?functionname

<span class="comment"># Download and install packages</span>
install.packages(<span class="string">"psych"</span>) <span class="comment">## Need to specify CRAN the 1st time</span>

<span class="comment"># Load package</span>
<span class="keyword">library</span>(psych)
</pre></td></tr></table></figure>

]]></content>
    <category scheme="http://yangliufr.com/tags/菜鸟学R语言/" term="菜鸟学R语言"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[赞成取消英语课]]></title>
    <link href="http://yangliufr.com/2013/09/12/yes-cancel-english-education/"/>
    <id>http://yangliufr.com/2013/09/12/yes-cancel-english-education/</id>
    <published>2013-09-11T23:13:40.000Z</published>
    <updated>2013-09-29T21:42:47.000Z</updated>
    <content type="html"><![CDATA[<p>近日打开新浪就看到这类话题，貌似一个叫王旭明的人在为教育事业出谋划策，我等受教育多年的人士定有一些要表达的，且听我一一道来。
<a id="more"></a></p>
<p>点题，英语课确实需要取消。</p>
<h3 id="-">英语特长生？</h3>
<p>伴随着取消还要取消高考中考的英语考试，只考语文、数学以及文理的其他科目即可，而英语可以走如今艺术特长生的路，各大学外语专业，或者所有专业，可以给出一部分名额，用来招收英语特长生。第一，这样可以保证外语人才的不流失，而且提高生源质量。第二，其他专业也可根据学科发展需要招收一定的外语特长生，给予特殊的培养方案。为什么要如此设置？</p>
<h3 id="-">外语不是知识，只是个工具而已</h3>
<p>工具，不是生活必需品。谁家可能都有个锤子、螺丝刀的，就算没有，敲开邻居大爷的门，借一把临时救个急也不会影响生活。而语文数学，就是生活必需品，你去超市菜市场买东西，不会说话不认字可不行，算不清自己有多少钱、该带多少钱也不行。你不会外语，可以，生活继续，不受影响，需要用的时候找会的人帮忙即可。</p>
<p>不喜欢学英语的人，可以不受此限制，而根据自己其他的优势选择喜欢的专业；而喜欢英语或者英语好的人，也有等同的机会选择，而有专门的培养计划让其能充分用到英语。教育的细分、多样化，在我十几亿人口的泱泱大国，是何等重要。</p>
<h3 id="-">现在的英语教育救了多少人，就害了多少人</h3>
<p>道理很简单，能把英语学以致用的人，大一统的英语教育就等于惠其一生；反之，在英语还是招考、用人单位等的评价标准时，其他找不到门路或者没有舞台发挥的人，英语教育等于浪费了他们的青春。教育本不应将一部分人的成功建立在另一部分人的失败的基础上。教育，应因材施教。</p>
<h3 id="-">法国又是个啥情况</h3>
<p>之前有缘接触过初中没上完就来法国独闯的一个浙江温州小伙子，他目前已经通过自己的努力进入到了法国的高等教育体系中，选择的专业也是令人羡慕的某工程类专业。他了解中国教育，也深谙法国教育。据他介绍，法国也有类似高考的制度，具体考试科目和一年考几次，我不是很清楚。但学生考完后，会分成两拨，一拨成绩很突出的，如果他们愿意，可以进入到下一轮的考试备战中，考更专业的科学知识，以后进入大学就是走科学家、工程师的道路；另一拨，也可以进入大学，学习的就是技术类专业。其实，可以简单理解为，第一次考试，是高中毕业考试，你过了一定分数线，加上自己兴趣所在，可以选择继续参加选拔考试，据说竞争激烈程度不亚于中国的高考。这两拨人是有机会进入同一所大学的，只是选择专业范围上互不相同。</p>
<p>好了，介绍半天，跟英语屁关系没有。我第一次听到这个，感到法国的教育确实非常人性化。即便如此，现在法国人在法国找工作，英语水平也会作为考核指标来参考，大学里也有英语课程，学生需要考过一定级别才能毕业（之前脚受伤在医院跟实习医生聊天了解到的）。你要知道，英法两国可是有着错综复杂的关系的，不亚于中日关系。但毕竟英语是世界最通用的语言，没有之一。虽然法国年龄大的普通人是不喜欢在公共场合说英语，但他们的年轻人接受的英语普及度已经很高了。就不分析原因了，肯定和经济文化和国际局势都有关。</p>
<p>就我个人而言，我肯定是受益于英语的，目前国际上最先进的资料都是用英语写的，我很享受其中。但我要说个题外话，就是日本。日本的物理学、机械电子等学科是绝对领先世界其他国家的包括美国，我注意到，日本索尼、任天堂等公司在新产品发布会上，主讲人是日本人，会用流利的美式英语介绍产品。但当播放产品介绍短片时，里面会偶尔出现产品设计工程师的介绍片段，这些工程师无一例外都是日本人，也无一例外都说的日语，下面配上英文字幕。为什么？大家自己心里都有自己的判断。
每个人都是教育家</p>
<p>因为，没有人比你更了解自己，或者自己的孩子。只是要注意一点，我们都只是个普通人，只要做个对社会有益的人就够了。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/一些思考/" term="一些思考"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[这世界永远不缺idea]]></title>
    <link href="http://yangliufr.com/2013/09/06/the-world-is-full-of-ideas/"/>
    <id>http://yangliufr.com/2013/09/06/the-world-is-full-of-ideas/</id>
    <published>2013-09-05T23:13:40.000Z</published>
    <updated>2013-09-28T13:41:45.000Z</updated>
    <content type="html"><![CDATA[<p>开学了，今天和两位导师见了面开了会。新学期第一天上班的时候，我就发邮件给他们讲了我关于实验的“新”想法，老师的回复是it’s interesting。
<a id="more"></a>
这对我来说，就是可以在小会议上讨论了。因为正在写之前实验结果的讨论部分，所以看了很多文献，有很多想要做的。由于目前我的采样方法是取野外河流中的样本回到实验室直接做，我想设计一个设备，在实验室就可以模拟河流，而不需要拘束于野外的条件变化和不确定性了，毕竟考虑到生物实验周期长，万一天有不测风云（雨水多），一年就过去了。其实设备很简单，需要pvc板、小型浸没式水泵、管子、防水胶水、各种工具等，如果在国内，这些1000块钱以内肯定搞定了。但在这边，走实验室的预定程序很复杂周期长，确实耽误时间。我主要考虑这是一劳永逸的事情，因为我要等河流水位降到一定程度，才能去采样，如果花三个月做好这个装置，以后可以在水位高的时候也在做实验，反而更有效率。而且我是有了想法后去搜索文章，确认我这个方向有人在做实验室培养的实验，果然有，而且那个组06年搞了这个设备，做了可行性研究发了个&gt;3.0的，在生态学方面这个已经足够回国副教授了，然后09年那个组就发了nature子刊&gt;8.9。当然，他们发nature不可能是仅仅因为做了个装置，像他们做分子生物之类的，我们就不具备条件，只能找合作，但这个临时是找不来的。</p>
<p>会上，大导师首先就问，你为什么要再造一个工具？我答，因为我的研究计划里是研究河流的，目前我的方法是静水，所以我需要流动的水。然后我就讲了要多做几种处理，采样时间有调整，探究的东西不局限于之前的几个养分，可能还要加入污染物。但污染物这个方向似乎超出了导师的计划，导师还是回到了问题的本源，让我先把文章写好总结好，再根据第一篇文章的讨论部分提出的新假设，来紧贴主题的设计下一步实验，去验证第一次的结果和提出的其他假设。</p>
<p>然后，小导师就帮忙圆场，说我这是conference effect，刚从韩国开完会回来，肯定头脑风暴了一下，有很多想法很好也很正常。而且关于这个装置，他们以前做过类似的出来，效果不好，然后就帮我去找来了，介绍了一下优缺点。我问了下，一起分析了不好的原因，确实有几个问题他们之前没考虑，设计上有问题，我已经考虑到了。但无论如何，我是不可能在我这三年内做这个了。顶多我用他们的这个失败装置改改再做一遍。</p>
<p>好了，大概就是这个事情，我开始肯定会有失望，想想是怪自己太激进了？也不是，因为我们还要和流体物理实验室合作做另一个不同的项目，他们有大型的河流模拟装置，但那个只有一个，只能做一种处理，不符合我们要验证假设的实验设计。而我要设计的不光可以满足目前的需求，还能有助于与其他实验室的合作。Anyway，导师总是对的，我也没有错，只是观点的不一致。大导师已经60多了，见多识广，知道你这么浅尝辄止的可能后果，想一步一步走踏实了，但对于新思路可能接受起来慢一些，缺乏激情，这也是公派项目校方负责人跟我提醒过的，有点不energetic。</p>
<p>好吧，我就安心的一步一步做，把每个假设都用双重结果去认定，层层叠码，这样似乎有好处，慢慢得到同行的认可，而不是一口吃个胖子或者干脆饿死了。我还是很怀念当时硕士的时候做实验的环境，所有都是我自己搞，真的是所有，课题就是导师给了个题目，让我去看文献吧，我是很享受这种全局掌控的感觉。当然，现在实验室的同学提醒我说，自己设计装置很麻烦，要调试很多参数，要考虑的事情很多，很容易失败。其实也对，但我觉得，尼玛如果啥事都那么容易成功还有啥含金量，我都考虑进去不就行了，老子不怕麻烦！</p>
<p>到了点题的时候了，看来本文多半是偏题了。没错，跟导师沟通了之后，觉得idea可以有很多，关键在于你要对每一个idea负责到底。对我来说，我不认为是我的执行力和延续性问题，就是对待一个课题是要三步并作两步的走，还是寻找那走两步退一步之后的海阔天空的问题。节奏，对是节奏问题。题外话，今天看了小米的新闻，小米3和小米电视，感觉对于这个国内最具活力的互联网软硬兼施的创业公司来说，节奏稍稍快了点，貌似上了一个新台阶，并同时在寻求全球市场的突破。来日方长嘛，突破，就是要破才行，如何才能破，就是要让人心服口服，如何才能心服口服呢，文章，快点出文章吧。如果你已经达到毕业要求了，导师管你做什么呢，巴不得多榨点油水呢。</p>
<p>后记：这篇比较水，逻辑性不强，参考意义不大，影响因子个位是0，没有十位等，小数点后N位才看得到非0数字，N为人类头发根数，人类不属于葛优等同类型人种。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/一些思考/" term="一些思考"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[暂别法国一个月]]></title>
    <link href="http://yangliufr.com/2013/07/05/live-a-one-month-vacation/"/>
    <id>http://yangliufr.com/2013/07/05/live-a-one-month-vacation/</id>
    <published>2013-07-04T23:13:40.000Z</published>
    <updated>2013-09-29T21:41:03.000Z</updated>
    <content type="html"><![CDATA[<p>一年前，国内硕士毕业的时候，别人都在留恋校园的感受，我却在那准备去内蒙古的国际会议，别人在收拾行李踏上回家的路，而我却只能望而却步，别人坐火车一去而不返，而我知道我走了，过两天还要回来面对空空的宿舍收拾行李。那种感觉特殊又难受。
<a id="more"></a>
这几天也这样，因为要去韩国开会，回国的票二月份就订好了。最近几天跟导师演练讲演了三次，有两次是昨天和今天，简直要把我推上悬崖似的。我必须一心二用，一边准备回国要带的各种东西，一边要静下心构思要演讲的内容，看似其实没什么啦，但对于处女座的男人，这似乎需要心中有把快刀，斩断眼前的乱麻，理清楚事情的优先级。而且韩国驻法国大使馆的工作效率问题，如果不在前天打电话催促，他们整个使馆的工作人员都去忙活接待来法的韩国企政要去了，只留下一个只会法语的大妈做接线员。明天就要走了，今天才拿到护照，你理解我的心情吧。</p>
<p>下午跟老师汇报完，虽然还不是很满意，但终于没有跟我太多压力，我主动表示回国后会把演讲文本写好发过来，并录制一段演讲视频发过来作为参考。最终敲定稿子之后，他们才能舒一口气吧，毕竟我是代表整个实验室去参加的。我想，如果我能把导师的演讲技术学到，以后就能到处“忽悠”了。目前，我非常急迫的意识到了这一点，这比写论文难得多。</p>
<p>我从内心里很重视这次会议，我刚到法国的第三天就进实验室了，第一周就开始讨论试验计划，经导师介绍后，第一个月就决定要参加这次在韩国举办的三年一届的会议。中间当然也经历了一段调整期，不知道要学什么，怎么学。还好目前已经进入了状态，从自我膨胀到自我怀疑，到了自我反省的阶段了。对我来说，估计还要来一两次如此的循环。</p>
<p>一首打油诗，以表此时的心情。</p>
<p>依依不舍地离开，<br>时间怎样停下来，<br>一片云彩都不带，<br>弥足珍贵是现在。<br>窗内才子望窗外，<br>碧蓝天空邃似海，<br>雄鹰翱翔高又快，<br>心里却念家乡菜。  </p>
]]></content>
    <category scheme="http://yangliufr.com/tags/一些思考/" term="一些思考"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[菜鸟学R语言：如何比较两组均值有无显著差异]]></title>
    <link href="http://yangliufr.com/2013/06/29/r-comparing-two-samples/"/>
    <id>http://yangliufr.com/2013/06/29/r-comparing-two-samples/</id>
    <published>2013-06-29T00:00:00.000Z</published>
    <updated>2013-10-02T13:12:43.000Z</updated>
    <content type="html"><![CDATA[<p>用R时间久了，确实非常方便，因为很多自定义的东西可以写。可能其他商业统计软件也可以吧，但没有R开源，长话短说。
<a id="more"></a></p>
<p>比较两组数据的均值有无显著差异时，要选择适当的检验对其进行分析，如下表：</p>
<table>
<thead>
<tr>
<th></th>
<th style="text-align:right">符合零假设</th>
<th style="text-align:center">不符合零假设</th>
</tr>
</thead>
<tbody>
<tr>
<td>比较两组独立样本</td>
<td style="text-align:right">独立t检验</td>
<td style="text-align:center">Mann-Whitney检验</td>
</tr>
<tr>
<td>比较两组配对样本</td>
<td style="text-align:right">配对t检验</td>
<td style="text-align:center">Wilcoxon检验</td>
</tr>
</tbody>
</table>
<p>所以，首先要确定你的数据是独立的（<code>unpaired</code>）还是配对的（<code>paired</code>）。举个例子，有两杯水，一杯是纯净水A，一杯是自来水B，实验第一天我们测一下其中氯离子浓度，十天后，再测一次。如果你要比较第十天，A与B之间的差异，就要进行独立检验；如果你要比较第一天的B和第十天的B有什么不同，那就要进行配对检验。</p>
<p>选择好了数据形式之后，要检验其是否符合正态分布、方差齐性等t检验的零假设条件，才能最终确定使用哪种方法得到我们想要的p值。因此，这里就存在一个变数，如果各组数据都符合或都不符合零假设，都还好，就怕有的符合有的不符合，这样在有很多对数据都要进行两两比较时，就比较麻烦了。</p>
<p>我就针对我的个人需求写了个小函数，减少了工作量，提高了成就感，即先用<code>levene</code>检验判断方差齐性，<code>p &gt; 0.05</code>的表示方差齐，然后才能进行t检验，否则进行相对应的非参数检验。在这里分享出来：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre>p_value = <span class="keyword">function</span>(x,y,z){
  x=data.frame(x)
  y=data.frame(y)
  c=nrow(x)
  d=nrow(y)
  colnames(x)=<span class="string">'variable'</span>
  colnames(y)=<span class="string">'variable'</span>
  a=data.frame(rep(<span class="string">'A'</span>,c))
  b=data.frame(rep(<span class="string">'B'</span>,d))
  colnames(a)=<span class="string">'group'</span>
  colnames(b)=<span class="string">'group'</span>
  data=data.frame(variable=rbind(x,y),group=rbind(a,b))
  <span class="keyword">if</span>(leveneTest(variable~group,data)$Pr[<span class="number">1</span>] ==<span class="string">'NaN'</span>){
    print(<span class="literal">NA</span>)
  }<span class="keyword">else</span>{
    <span class="keyword">if</span>(leveneTest(variable~group,data)$Pr[<span class="number">1</span>] &gt;<span class="number">0.05</span>){
      t.test(x,y,paired=z)$p.value
    }<span class="keyword">else</span>{
      wilcox.test(data[<span class="number">1</span>:c,<span class="number">1</span>],data[(c+<span class="number">1</span>):(c+d),<span class="number">1</span>],paired=z)$p.value
    }
  }
}
</pre></td></tr></table></figure>

<p>使用起来很简单，从数据框中选择两组数据，然后标记是独立样本（<code>TRUE</code> 或 <code>T</code>）还是配对样本（<code>FALSE</code> 或 <code>F</code>）。例如，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>&gt; a=c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">0</span>)
&gt; b=c(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">4</span>)
&gt; p_value(a,b,<span class="literal">TRUE</span>) <span class="comment">#for unpaired data</span>
[<span class="number">1</span>] <span class="number">0.8316408</span>
&gt; p_value(a,b,<span class="literal">FALSE</span>) <span class="comment">#for paired data</span>
[<span class="number">1</span>] <span class="number">0.9358497</span>
</pre></td></tr></table></figure>

<p>最后，大家可以根据需要修改。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/菜鸟学R语言/" term="菜鸟学R语言"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[农药：中药里的秘制配方？]]></title>
    <link href="http://yangliufr.com/2013/06/29/pesticide-formula-in-chinese-medicine/"/>
    <id>http://yangliufr.com/2013/06/29/pesticide-formula-in-chinese-medicine/</id>
    <published>2013-06-28T23:13:40.000Z</published>
    <updated>2013-09-29T21:41:24.000Z</updated>
    <content type="html"><![CDATA[<p>传统中草药有着很高的医药价值，但绿色和平-东亚的一项调查显示，这些中草药有很多农药残留，反而对人体健康又潜在危害。</p>
<p>在中国，这些草药产品每天都会被搬上千家万户的餐桌上，早已成为中国烹饪文化遗产。人们会在汤或茶里放人参、红枣或者菊花，来治疗各种疾病。
<a id="more"></a>
不仅仅在中国，其他国家希望把中草药当做替代疗法的人们也非常多，<a href="http://www.who.int/bulletin/volumes/86/8/07-042820/en/" target="_blank">每年全球的市场价值达600亿美元</a>，增长迅速。</p>
<p>但在这份研究报告中，《中草药：给人治病的药剂还是杀虫剂？》，对65个中草药产品进行了抽样调查，发现所有产品中都有一定量的农药残留，而且有些农药是中国明令禁止使用的。</p>
<p><img src="/img/pesticideherb_thumb.jpg" alt="herb-pesticide"></p>
<p>很多中草药产品是在化学集约农业的模式下培养出来的，早就不是野生采摘的了，所以现在很难找到无毒无害食物。检测报告显示，很多被世界卫生组织认定的高毒性物质都又被监测出来，而且残留浓度已经超过欧洲食品安全标准。这类有害物可以在人体内进行生物积累，慢性农药中毒会导致痴呆、荷尔蒙紊乱和丧失生育功能。</p>
<p><img src="/img/pesticideherb1_thumb.jpg" alt="herb-pesticide"></p>
<p>绿色和平-东亚正在督促中国政府严格监管控制非法农药的使用，并提供减少农药使用量的时间表，承诺彻底根除农药在农业生产中的应用。此外，绿色和平组织呼吁中国政府将更多资金投入到生态农业的实践中去。</p>
<p>而生态农业项目也是绿色和平组织正在极力推广的，详见网页：</p>
<p><a href="http://www.greenpeace.org/international/en/campaigns/agriculture/solution-ecological-farming/" target="_blank"><a href="http://www.greenpeace.org/international/en/campaigns/agriculture/solution-ecological-farming/">http://www.greenpeace.org/international/en/campaigns/agriculture/solution-ecological-farming/</a></a></p>
<p>本文编译自<a href="greenpeace.org">greenpeace.org</a></p>
]]></content>
    <category scheme="http://yangliufr.com/tags/绿色和平/" term="绿色和平"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[Journal Club 论文里过多的数学公式会吓跑生态学家吗]]></title>
    <link href="http://yangliufr.com/2013/06/27/math-equations-will-frigten-ecologist/"/>
    <id>http://yangliufr.com/2013/06/27/math-equations-will-frigten-ecologist/</id>
    <published>2013-06-27T00:00:00.000Z</published>
    <updated>2013-09-29T21:41:12.000Z</updated>
    <content type="html"><![CDATA[<p>上上周参加的实验室的Journal Club活动（每周有不同的人根据自己的研究或者已有的研究来介绍给大家，一起讨论），所讲论文题目是<a href="http://www.pnas.org/content/early/2012/06/22/1205259109.abstract" target="_blank">Heavy use of equations impedes communication among biologists</a>（重度在论文中使用数学公式，或阻碍理论生物学家和应用生物学家间的交流）。
<a id="more"></a></p>
<p>这篇论文的作者是英国布里斯托大学（University of Bristol）生物科学学院的Tim Fawcett。他们分析了生物生态方向的[Ecology]和[Evolution]两本杂志中的650篇论文，并在摘要中写道，</p>
<ul>
<li>论文中数学公式的密度对该论文被引用率有显著影响，每页论文正文中每添加一个公式，就会使整篇论文的被引用率减少28%。</li>
</ul>
<ul>
<li>写有高密度数学公式的论文的被引用率，比极少使用公式的论文低50%。</li>
</ul>
<ul>
<li>尽管，拥有高密度数学公式的论文会更容易被其他理论研究的文章引用，但会大幅减少其他非理论研究论文对其的引用率（平均每页每添加一个公式，会减少非理论研究论文对该论文35%的引用率）。</li>
</ul>
<ul>
<li>如果论文有目录（appendix）用于解释文中提到的公式，就不会影响论文的被引用率。</li>
</ul>
<p>换句话说就是，尽管都是科学家（或者研究人员吧），但还是术业有专攻的，理论研究者写的满篇公式，能否得到实验或应用学科的理解、验证、使用，是一个很大的问题。的确，一个发表出来的理论研究结果，既能够得到同行的认可，又能被广泛应用去验证的是很难的事情，但这并不是作者不去想办法简化她的理由。我能粗浅地体会，一个模型从无到有，作者所花费的脑力劳动要远比我们实验学科平时做实验和处理数据来得多得多，所以作者都想呈现出所有的内容。正巧最近在准备国际会议的讲演，之前刚做过面对大实验室的年度报告，在准备过程中就感觉，虽然内容都一样，没什么变化，但面对的听众不一样，所展示的方式方法，措辞就要有所区别，有的甚至要重新设计。所以，其实写论文、做讲演就是一场营销战，know your audience，要告诉读者、听众他们想知道的。</p>
<p>回到本文话题中，撰写一篇论文的时候，可能脑海中想象的更多的是杂志审稿人和同行的身影，同时假定想要使用我的研究成果的人，也都是专家咯，而科普的工作就由大师去做吧。暂时不可能在正文篇幅中，增加解释的语句。所以可能的解决方案（很多作者已经这么做的）是，给文章添加附录，并在杂志网站上提供附件下载，而且不会影响论文的引用率。但问题来了，很少有人会在下载完论文文档之后，再回到网站页面单独下载附录文件，因为当读者看到很多公式的时候就已经开始挠头了，可能会果断关闭该文档，继续寻找表达更清楚的论文，直到你确认这篇是有且唯一你需要的，你才会霸王硬上弓，这无非增加了时间成本，效率较低。</p>
<p>所以我想，什么传统杂志、开源杂志，纸质版、网络版，在自媒体时代，所有实验室都开博客吧，读者可以直接在论文下面留言提问，并在下载论文时可以选择是否下载投票数最高的评论。乍一看这和现在作者在论文中所留下的电子邮件地址有什么区别，但这会让读者更有沟通欲望。所以，一旦有对理论研究中有疑问的读者，都可以提问，而且可以极大程度的避免重复提问。当然，提问者要经过学校邮箱验证等其他手段来杜绝垃圾评论。如果能整合到research gate中，那简直是极好的。</p>
<p>其实，多半可能，这件事就这么一闪而过的，还是让科学工作者多学学市场营销学最为实际，只不过名字可以改改，叫科学营销学吧。这可能就是平常所说的会不会拉项目吧，呵呵。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/Journal Club/" term="Journal Club"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[菜鸟学R语言：用R抓取价格数据，当红单反性价比排行出炉]]></title>
    <link href="http://yangliufr.com/2013/05/17/r-camera-top-ten/"/>
    <id>http://yangliufr.com/2013/05/17/r-camera-top-ten/</id>
    <published>2013-05-17T00:00:00.000Z</published>
    <updated>2013-10-02T13:12:12.000Z</updated>
    <content type="html"><![CDATA[<p>上次写了<a href="http://yangliufr.com/2013/05/06/%e8%8f%9c%e9%b8%9f%e5%ad%a6r%e8%af%ad%e8%a8%80%ef%bc%9a%e7%94%a8r%e5%88%86%e6%9e%90%e5%93%aa%e6%ac%be%e7%9b%b8%e6%9c%ba%e6%80%a7%e4%bb%b7%e6%af%94%e6%9c%80%e9%ab%98/">如何用R分析哪款相机性价比最高</a>的文章，由于抓取的相机性能评分网站Dxomark.com上的价格数据不是实时更新的。所以，我又找了些方法学习如何抓取电商上的价格数据。
<a id="more"></a></p>
<h3 id="-">选哪个电商网站的商品价格</h3>
<p>国内就全国而言比较良心的综合类电商就属“京东商城”和“亚马逊中国”了，像苏宁易购、一号店等的价格优势都各有偏重，价格更新不如京东和亚马逊能够及时反映数码产品快速变化的市场走势。然后，由于京东对网页抓取价格的行为进行了限制，对商品网页中的价格进行了图片加密，虽然页面显示是可以直接拷贝文本，但html源代码中只有图片链接。估计，用python的一些图片识别库是可以抓的，因为有网站做得挺好，比如“西贴（<a href="www.xitie.com/360buy/">www.xitie.com/360buy/</a>）”。</p>
<p>所以，我选择了对价格战敏感度较低的亚马逊中国的商品进行价格抓取。此法同样适用于亚马逊其他网站，因为其网页源代码是类似的。</p>
<h3 id="-">人工获取商品代码</h3>
<p>由于要对特定商品进行价格抓取，而不是一劳永逸的提供用户搜索，让用户选择商品。所以，必须预先获取商品的链接。幸好单反相机的商品品类不多，全靠我一个个复制粘贴而来。我没有选择全选搜索而来的链接，只选了商品代码，比如，</p>
<p><a href="http://www.amazon.cn/gp/product/**B00C93NHHY**/ref=s9_simh_gw_p421_d0_i1?pf_rd_m=A1AJ19PSB66TGU&amp;pf_rd_s=center-3&amp;pf_rd_r=10TJ5625EJ46C17SN3ZN&amp;pf_rd_t=101&amp;pf_rd_p=58223152&amp;pf_rd_i=899254051" target="_blank">http://www.amazon.cn/gp/product/**B00C93NHHY**/ref=s9_simh_gw_p421_d0_i1?pf_rd_m=A1AJ19PSB66TGU&amp;pf_rd_s=center-3&amp;pf_rd_r=10TJ5625EJ46C17SN3ZN&amp;pf_rd_t=101&amp;pf_rd_p=58223152&amp;pf_rd_i=899254051</a></p>
<p>链接中粗体部分就是我需要的代码，后面都是返利或者浏览行为追踪的代码。</p>
<p>就这样，我选取了亚马逊有货的67款相机来进行抓取和分析，包括佳能、尼康、索尼、富士、松下、奥林巴斯，这六个品牌的入门单反、半专业单反、普通便携、高端便携、微型单反，这五种分类分别进行比较。</p>
<p>首先，把商品链接存入一个数据框中，如下图：</p>
<p><img src="/img/cc1_thumb.png" alt="camera1"></p>
<p>然后就可以用XML包里的htmlParse函数对网页进行解析，然后用火狐或Chrome开源代码，找到包裹价格和商品名的html代码（我不知道具体应该怎么叫这个），为了这个还专门看了xpath相关的背景知识，啃了半天。其实也可以用正则表达式，这玩意看起来语法更麻烦，反正我的需求很小，就不学了。如图，选中价格，右键选择“查看选中部分源代码”，即可。</p>
<p><img src="/img/cc2_thumb.png" alt="camera2"></p>
<p>为了核对商品名和价格，并和之前的数据库进行合并，所以商品名也要抓取。同理。</p>
<p>价格抓取的函数如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre>pricefinder&lt; -<span class="keyword">function</span>(url){
  name_text&lt;-<span class="string">""</span>
  price_text&lt;-<span class="string">""</span>
  i&lt;-<span class="number">1</span>
  <span class="keyword">for</span>(i_url <span class="keyword">in</span> url){
    i_url2&lt;-htmlParse(i_url,encoding=<span class="string">"UTF-8"</span>)  <span class="comment">##对html网页进行解析</span>
    name&lt;- getNodeSet(i_url2,<span class="string">"//span[@id='btAsinTitle']"</span>)  <span class="comment">##根据xpath路径，定位要抓取的数据</span>
    name_text_tmp&lt;-xmlValue(name[[<span class="number">1</span>]]) <span class="comment">##用xmlValue读取节点数据并暂存</span>
    price&lt;-getNodeSet(i_url2,<span class="string">"//b[@class='priceLarge']"</span>)
    <span class="keyword">if</span>(price[<span class="number">1</span>] == <span class="string">'NULL'</span>){  <span class="comment">##判断商品是否无货，即没有价格标签</span>
      price_text_tmp = <span class="string">"out of stock"</span>
    }<span class="keyword">else</span>{
      price_text_tmp &lt;- xmlValue(price[[<span class="number">1</span>]]) 
    }
    name_text[i]&lt;-name_text_tmp
    price_text[i]&lt;-price_text_tmp
    i&lt;-i+<span class="number">1</span>
  }
  data.frame(name=name_text,price=price_text)
}
</pre></td></tr></table></figure>

<p>然后，执行该函数，获得的数据框如下，</p>
<p><img src="/img/cc3_thumb.png" alt="camera3"></p>
<p>看出里面有乱码，无所谓，去掉就好了，反正就算是汉字也是要去掉的。然后进行一下合并处理。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>r1[,<span class="number">2</span>] = sub(<span class="string">'^..'</span>,<span class="string">''</span>,r1[,<span class="number">2</span>])
r1[,<span class="number">2</span>] = gsub(<span class="string">','</span>,<span class="string">''</span>,r1[,<span class="number">2</span>])
</pre></td></tr></table></figure>

<p>这样抓取过程就差不多了。下面就要考虑如何处理这些数据了。由于本人逃过很多数理统计课去打篮球了，为了避免不同相机的性能评分差异和价格差异不同，需要更多数据对其进行标准化后，才能得出可信的性价比。所以，干脆对其进行排序，得出排名作为其分数，这里使用的是R中的rank函数，很简单，代码就不放了。此外，为了针对不同用户，并对每一款相机负责的态度，我们先不进行全部排名，而是分类排名。</p>
<h3 id="-">普通便携相机</h3>
<table>
   <tr>
      <td>Model </td>
      <td>Type </td>
      <td>pricermb </td>
      <td>ppratio</td>
   </tr>
   <tr>
      <td>Canon PowerShot S100 </td>
      <td>Compact </td>
      <td>1794.1 </td>
      <td>3</td>
   </tr>
   <tr>
      <td>Fujifilm FinePix F600EXR </td>
      <td>Compact </td>
      <td>1250 </td>
      <td>2</td>
   </tr>
   <tr>
      <td>Canon Powershot S110 </td>
      <td>Compact </td>
      <td>2288 </td>
      <td>1.5</td>
   </tr>
   <tr>
      <td>Fujifilm XF1 </td>
      <td>Compact </td>
      <td>2549 </td>
      <td>1.4</td>
   </tr>
   <tr>
      <td>Panasonic Lumix DMC LX7 </td>
      <td>Compact </td>
      <td>2699 </td>
      <td>1.285714</td>
   </tr>
   <tr>
      <td>Fujifilm FinePix X10 </td>
      <td>Compact </td>
      <td>2788 </td>
      <td>1.125</td>
   </tr>
   <tr>
      <td>Canon Powershot G12 </td>
      <td>Compact </td>
      <td>2688 </td>
      <td>0.75</td>
   </tr>
   <tr>
      <td>Fujifilm FinePix F550EXR </td>
      <td>Compact </td>
      <td>1613.6 </td>
      <td>0.5</td>
   </tr>
   <tr>
      <td>Canon PowerShot SX50 HS </td>
      <td>Compact </td>
      <td>3059 </td>
      <td>0.5</td>
   </tr>
   <tr>
      <td>Canon Powershot G15 </td>
      <td>Compact </td>
      <td>3099 </td>
      <td>0.3</td>
   </tr>
</table>
可见，佳能的S100胜出，富士F600exr（国内型号F665exr）和佳能S110分列二三位。

<img src="/img/canons100_thumb.jpg" alt="canons100">

###高端便携相机

<table>
   <tr>
      <td>Model </td>
      <td>Type </td>
      <td>pricermb </td>
      <td>ppratio</td>
   </tr>
   <tr>
      <td>Sony Cyber-shot DSC-RX100 </td>
      <td>High-end compact </td>
      <td>3772.9 </td>
      <td>1.666667</td>
   </tr>
   <tr>
      <td>Canon PowerShot S95 </td>
      <td>High-end compact </td>
      <td>2199 </td>
      <td>1</td>
   </tr>
   <tr>
      <td>Sony Cyber-shot DSC-RX1 </td>
      <td>High-end compact </td>
      <td>18988 </td>
      <td>1</td>
   </tr>
   <tr>
      <td>Fujifilm FinePix X100 </td>
      <td>High-end compact </td>
      <td>6819 </td>
      <td>1</td>
   </tr>
   <tr>
      <td>Canon PowerShot G1X </td>
      <td>High-end compact </td>
      <td>3939 </td>
      <td>1</td>
   </tr>
   <tr>
      <td>Panasonic Lumix DMC LX5 </td>
      <td>High-end compact </td>
      <td>2198 </td>
      <td>1</td>
   </tr>
   <tr>
      <td>Nikon 1 V2 </td>
      <td>High-end compact </td>
      <td>5499 </td>
      <td>0.6</td>
   </tr>
</table>

<p>果然是高端机，大家差距都不大，或者可以说是一分钱一分货，没啥好比的。索尼的黑卡相机RX100勇夺冠军，其他五款并列亚军，尼康V2位列最后并获得珍贵的季军。</p>
<p><img src="/img/rx100.jpg" alt="rx100"></p>
<h3 id="-">半专业单反</h3>
<table>
   <tr>
      <td>Model </td>
      <td>Type </td>
      <td>pricermb </td>
      <td>ppratio</td>
   </tr>
   <tr>
      <td>Nikon D7000 </td>
      <td>Semi-Pro DSLR </td>
      <td>6188 </td>
      <td>2.5</td>
   </tr>
   <tr>
      <td>Nikon D7100 </td>
      <td>Semi-Pro DSLR </td>
      <td>8199 </td>
      <td>2</td>
   </tr>
   <tr>
      <td>Canon EOS 60D </td>
      <td>Semi-Pro DSLR </td>
      <td>5399 </td>
      <td>1.5</td>
   </tr>
   <tr>
      <td>Nikon D600 </td>
      <td>Semi-Pro DSLR </td>
      <td>11111 </td>
      <td>1.428571</td>
   </tr>
   <tr>
      <td>Canon EOS 6D </td>
      <td>Semi-Pro DSLR </td>
      <td>10900 </td>
      <td>1.166667</td>
   </tr>
   <tr>
      <td>Nikon D800E </td>
      <td>Semi-Pro DSLR </td>
      <td>18199 </td>
      <td>1.142857</td>
   </tr>
   <tr>
      <td>Nikon D800 </td>
      <td>Semi-Pro DSLR </td>
      <td>18199 </td>
      <td>1.047619</td>
   </tr>
   <tr>
      <td>Sony SLT Alpha 99 </td>
      <td>Semi-Pro DSLR </td>
      <td>17800 </td>
      <td>1</td>
   </tr>
   <tr>
      <td>Sony SLT Alpha 77 </td>
      <td>Semi-Pro DSLR </td>
      <td>7474.9 </td>
      <td>1</td>
   </tr>
   <tr>
      <td>Canon EOS 5D Mark II </td>
      <td>Semi-Pro DSLR </td>
      <td>12590 </td>
      <td>0.5</td>
   </tr>
   <tr>
      <td>Canon EOS 5D Mark III </td>
      <td>Semi-Pro DSLR </td>
      <td>19488 </td>
      <td>0.5</td>
   </tr>
   <tr>
      <td>Canon EOS 7D </td>
      <td>Semi-Pro DSLR </td>
      <td>8499 </td>
      <td>0.3</td>
   </tr>
</table>

<p>Dxomark把这些都叫做半专业，我不知道这星球上啥相机是专业的了。显然，在高端单反方面，DxoLab是尼康粉，佳能的无敌兔和无敌伞位列倒数第二和第三位，与之对应的尼康D800和D800E则排在中游，中规中矩。此外，索尼在高端单反方面一直处于中下游，因此，对该结果并不意外，所以的策略显然更多在微单上了。冠亚军分别被尼康的D7000和D7100获得。</p>
<p><img src="/img/d7000.jpg" alt="d7000"></p>
<h3 id="-">入门单反</h3>
<table>
   <tr>
      <td>Model </td>
      <td>Type </td>
      <td>pricermb </td>
      <td>ppratio</td>
   </tr>
   <tr>
      <td>Nikon D3200 </td>
      <td>Entry-level DSLR </td>
      <td>3070 </td>
      <td>11</td>
   </tr>
   <tr>
      <td>Nikon D5100 </td>
      <td>Entry-level DSLR </td>
      <td>3550 </td>
      <td>3.333333</td>
   </tr>
   <tr>
      <td>Canon EOS 600D </td>
      <td>Entry-level DSLR </td>
      <td>3399 </td>
      <td>2</td>
   </tr>
   <tr>
      <td>Sony SLT Alpha 58 </td>
      <td>Entry-level DSLR </td>
      <td>3605.6 </td>
      <td>1.5</td>
   </tr>
   <tr>
      <td>Sony SLT Alpha 57 </td>
      <td>Entry-level DSLR </td>
      <td>3999 </td>
      <td>1.285714</td>
   </tr>
   <tr>
      <td>Nikon D5200 </td>
      <td>Entry-level DSLR </td>
      <td>4499 </td>
      <td>1.090909</td>
   </tr>
   <tr>
      <td>Nikon D90 </td>
      <td>Entry-level DSLR </td>
      <td>4208 </td>
      <td>0.666667</td>
   </tr>
   <tr>
      <td>Canon EOS 1100D </td>
      <td>Entry-level DSLR </td>
      <td>3600 </td>
      <td>0.625</td>
   </tr>
   <tr>
      <td>Sony SLT Alpha 65 </td>
      <td>Entry-level DSLR </td>
      <td>4899 </td>
      <td>0.625</td>
   </tr>
   <tr>
      <td>Canon EOS 550D </td>
      <td>Entry-level DSLR </td>
      <td>4299 </td>
      <td>0.5</td>
   </tr>
   <tr>
      <td>Canon EOS 650D </td>
      <td>Entry-level DSLR </td>
      <td>3880 </td>
      <td>0.416667</td>
   </tr>
   <tr>
      <td>Canon EOS 700D </td>
      <td>Entry-level DSLR </td>
      <td>4081 </td>
      <td>0.125</td>
   </tr>
</table>

<p>对尼康D3200获得冠军很意外，领先第二名足足6分之多，显然在性价比方面与其他11部相机拉开了差距。但也要理性看待，因为入门单反的价格基本集中在3000至5000之间，这也是普通用户开始考虑入手单反的心理价位区间。所以，既然是入门单反，根据自己喜好买就行，差别没有这张表上的那么差异大。</p>
<p><img src="/img/d3200.jpg" alt="d3200"></p>
<h3 id="-">微单（微型单反）</h3>
<p>我是有意把这个排名放在最后的，因为我觉得微单是普通用户享受摄影乐趣的最终归宿。具体原因可以再写一篇文章来阐述。</p>
<table>
   <tr>
      <td>Model </td>
      <td>Type </td>
      <td>pricermb </td>
      <td>ppratio</td>
   </tr>
   <tr>
      <td>Nikon 1 J1 </td>
      <td>Hybrid </td>
      <td>2319 </td>
      <td>11.5</td>
   </tr>
   <tr>
      <td>Olympus PEN E-PM2 </td>
      <td>Hybrid </td>
      <td>2999 </td>
      <td>2.75</td>
   </tr>
   <tr>
      <td>Sony NEX-3N </td>
      <td>Hybrid </td>
      <td>3099 </td>
      <td>2.571429</td>
   </tr>
   <tr>
      <td>Sony NEX-5R </td>
      <td>Hybrid </td>
      <td>3580 </td>
      <td>2.05</td>
   </tr>
   <tr>
      <td>Olympus PEN EPM1 </td>
      <td>Hybrid </td>
      <td>2499 </td>
      <td>2</td>
   </tr>
   <tr>
      <td>Nikon 1 J2 </td>
      <td>Hybrid </td>
      <td>2859 </td>
      <td>1.6</td>
   </tr>
   <tr>
      <td>Nikon 1 S1 </td>
      <td>Hybrid </td>
      <td>3182.3 </td>
      <td>1.4375</td>
   </tr>
   <tr>
      <td>Olympus PEN EPL3 </td>
      <td>Hybrid </td>
      <td>2599 </td>
      <td>1.25</td>
   </tr>
   <tr>
      <td>Sony NEX-6 </td>
      <td>Hybrid </td>
      <td>5076 </td>
      <td>1.138889</td>
   </tr>
   <tr>
      <td>Sony NEX-5N </td>
      <td>Hybrid </td>
      <td>4999 </td>
      <td>1.117647</td>
   </tr>
   <tr>
      <td>Sony NEX-7 </td>
      <td>Hybrid </td>
      <td>6890 </td>
      <td>1.1</td>
   </tr>
   <tr>
      <td>Olympus PEN E-PL5 </td>
      <td>Hybrid </td>
      <td>4199 </td>
      <td>1.03125</td>
   </tr>
   <tr>
      <td>Panasonic Lumix DMC GF2 </td>
      <td>Hybrid </td>
      <td>3399 </td>
      <td>0.888889</td>
   </tr>
   <tr>
      <td>Olympus OM-D E-M5 </td>
      <td>Hybrid </td>
      <td>6380 </td>
      <td>0.763158</td>
   </tr>
   <tr>
      <td>Nikon 1 V1 </td>
      <td>Hybrid </td>
      <td>3639 </td>
      <td>0.727273</td>
   </tr>
   <tr>
      <td>Panasonic Lumix DMC GX1 </td>
      <td>Hybrid </td>
      <td>4099 </td>
      <td>0.666667</td>
   </tr>
   <tr>
      <td>Panasonic Lumix DMC-GH3 </td>
      <td>Hybrid </td>
      <td>9998 </td>
      <td>0.659091</td>
   </tr>
   <tr>
      <td>Panasonic Lumix DMC GH2 </td>
      <td>Hybrid </td>
      <td>9400 </td>
      <td>0.619048</td>
   </tr>
   <tr>
      <td>Panasonic Lumix DMC GF5 </td>
      <td>Hybrid </td>
      <td>2499 </td>
      <td>0.6</td>
   </tr>
   <tr>
      <td>Nikon 1 J3 </td>
      <td>Hybrid </td>
      <td>3670.9 </td>
      <td>0.416667</td>
   </tr>
   <tr>
      <td>Olympus PEN EP3 </td>
      <td>Hybrid </td>
      <td>3899 </td>
      <td>0.230769</td>
   </tr>
   <tr>
      <td>Panasonic Lumix DMC GF3 </td>
      <td>Hybrid </td>
      <td>3975 </td>
      <td>0.107143</td>
   </tr>
</table>

<p><img src="/img/j1.jpg" alt="j1"></p>
<p>好家伙，尼康又夺魁了，很意外。在日本市场，可能尼康J1很畅销，但在大陆这款相机是非常小众的。微单方面，用户群最大的就是奥林巴斯的PEN系列和索尼的Nex系列。两家的旗舰级机器，奥林巴斯OM-D E-M5和索尼Nex 7的性价比分别排在中下游和中游水平。而在入门微单方面，奥巴的E-PM2战胜了索尼Nex 3N，分列本榜亚季军，但差距不大。用户再选择的时候，就要重点考虑两家的镜头群问题了，当然，这也是买微单的时候最需要考虑的。此外，过去很长一段时间索尼家热销的Nex 5N已经退出了目前市场上最具性价比相机的竞争了，其后续机型Nex 5R已经取代了她。</p>
<h3 id="-">便携性</h3>
<p>如果将机身重量作为便携性标准加入到性价比中，那么排名会是什么样的呢？下次再来讨论吧，顺便讲讲我个人的一点点业余的拍摄经验。</p>
<h3 id="-">后记：</h3>
<p>请注意，本文中的价格数据时基于2013年5月17日的亚马逊中国的当日价格，并且基本所有相机都是机身价格，如果亚马逊中没有机身卖，那就是搭配狗头（最廉价）的套餐价格。所以，可能对结果产生影响，大家就当做娱乐看待，各家的粉丝也不要喷我。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/菜鸟学R语言/" term="菜鸟学R语言"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[菜鸟学R语言：用R分析哪款相机性价比最高]]></title>
    <link href="http://yangliufr.com/2013/05/06/r-camera-1/"/>
    <id>http://yangliufr.com/2013/05/06/r-camera-1/</id>
    <published>2013-05-06T00:00:00.000Z</published>
    <updated>2013-10-02T13:11:32.000Z</updated>
    <content type="html"><![CDATA[<p>题目起得很大。本文只是博主为了学习R和解决一些实际问题而写的，只用了R中最简单的函数，希望读者不要有误会。</p>
<p>之所以想分析比较“哪款相机（机身）性价比最高”，主要是因为最近有几个同学都打算买相机了，毕竟在欧洲景点很多，买个好相机来留下精彩的瞬间。我也是刚摄影入门，有点自己的心得，因为还是学生，收入微薄，不可能尝试很多好机器和镜头，然后再主观评测器材的好坏，一是没钱，二是没这个辨别能力。所以，我就想能否有个客观的数据分析能够指导我们选购呢？那就不得不说法国DxO实验室了。</p>
<a id="more"></a>

<p>法国DxO实验室（<a href="http://www.dxomark.com/index.php/About/What-is-DxOMark2" target="_blank">DxO Labs</a>）位于法国布洛涅-比扬古（Boulogne-Billancourt），隶属于私有图像处理软件公司，旗下网站dxomark.com就是本文所用数据的来源。该公司所测试的相机涵盖了市面上大部分产品，采用工业级实验设备进行测试，并有数万计的镜头测试结果的数据库，所得到的测试评分可用来评估和比较数码相机和镜头的成像质量。</p>
<p>一般在相机新产品上市一段时间以后，Dxomark会经过测试给出该相机的评分。由于其专业性和中立性，经常会被器材党拿来讨论。本文采用的数据来源于：数码相机<a href="http://www.dxomark.com/index.php/Cameras/Camera-Sensor-Database" target="_blank">数据库</a>和<a href="http://www.dxomark.com/index.php/Cameras/Camera-Sensor-Ratings" target="_blank">评分</a>（点击直达原链接）。接下来，我就说说我的菜鸟思路，是如何获取这些数据，并在R下面操作的。</p>
<p>首先，我打开了相机评分的网页，其评分分为：Overall score（总分）、Portrait（人像摄影）、Landscape（景观摄影）和Sports（运动摄影）三项。这三项的网页格式是一致的，因此只以总分数据的采集举例。</p>
<p><img src="/img/c1.png" alt="R"></p>
<p>单击图中左下区域，右键选择“全选”，复制文本框中的数据，由于连图片也一起复制了，因此我们要粘贴到新建的一个txt文档中，以清除图片，并保留原文档的排列格式。然后在txt文档中直接全选复制粘贴到新建的excel里（注意粘贴时点击excel的第一个单元格），不作任何处理，另存为文本（text tab delimited）格式到Rstudio的工作路径即可。</p>
<p>下面就要转到Rstudio了，读取该txt文档，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>cd=read.table(<span class="string">"camera data.txt"</span>,header=<span class="literal">F</span>,sep=<span class="string">"\t"</span>)
</pre></td></tr></table></figure>

<p>你会发现有很多NA、空白和重复值，没关系，下一步就要取其精华了。</p>
<p><img src="/img/c2.png" alt="R"></p>
<p>先看每一款机型的名称、总分和排名共占有6个单元格，而整个表一共有1284行，因此共有1284/6=214款机型（当然这一步可以用函数代替，但我觉得对于格式杂乱的静态网页数据，还是具体问题具体分析的好）。下面就要写个循环来分别提取相机名称、相机总分和相机排名三列数据了。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="code"><pre>cdname=cdscore=cdrank=factor() <span class="comment">#这一步设置的原因未知，我是在debug时发现必须要先设置成factor才行</span>
<span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">214</span>){
  cdname1=droplevels(cd[((i-<span class="number">1</span>)*<span class="number">6</span>+<span class="number">2</span>),<span class="number">1</span>])  <span class="comment">#去掉多余的factor</span>
  cdname1=data.frame(lapply(cdname1,as.character),stringsAsFactors=<span class="literal">FALSE</span>) <span class="comment">#转换为字符数据框</span>
  cdname=rbind(cdname,cdname1[<span class="number">1</span>,<span class="number">1</span>]) <span class="comment">#合并行</span>
  cdscore1=droplevels(cd[((i-<span class="number">1</span>)*<span class="number">6</span>+<span class="number">4</span>),<span class="number">1</span>])
  cdscore1=data.frame(lapply(cdscore1,as.character),stringsAsFactors=<span class="literal">FALSE</span>)
  cdscore=rbind(cdscore,cdscore1[<span class="number">1</span>,<span class="number">1</span>])
  cdrank1=droplevels(cd[((i-<span class="number">1</span>)*<span class="number">6</span>+<span class="number">5</span>),<span class="number">1</span>])
  cdrank1=data.frame(lapply(cdrank1,as.character),stringsAsFactors=<span class="literal">FALSE</span>)
  cdrank=rbind(cdrank,cdrank1[<span class="number">1</span>,<span class="number">1</span>])
}
cd1=cbind(cdrank,cdname,cdscore)
cd1=as.data.frame(cd1)
colnames(cd1) = c(<span class="string">"ranks"</span>,<span class="string">"camera names"</span>,<span class="string">"overall scores"</span>)
</pre></td></tr></table></figure>

<p>此时的cd1就是这个样子了，
<img src="/img/c3.png" alt="R"></p>
<p>下面，我们开始提取dxomark.com上相机数据库的数据，因为里面有上市价格、相机类型、像素、重量、上市时间等数据（重量数据不全，价格数据不是现价，只做参考）。
<img src="/img/c4.png" alt="R"></p>
<p>像这样用鼠标选中数据区域，拉到最底下复制粘贴，和刚才的操作一样，该页面共有256款机型，包括了未测试的，我们选择每页显示50个项目，这样只需要重复操作6次就可得到所有数据，我承认这是非常笨的方法，只适合菜鸟。但我觉得对于这种非动态更新的网页静态数据，没有万金油的方法可以套，毕竟主动权掌握在网页设计者手中。所以，我认为掌握一些笨方法对于极小数据量是很有用的。然后我们就得到了，</p>
<p><img src="/img/c5.png" alt="R"></p>
<p>同样，也有很多空行和NA值，并且有几十款机型由于各种原因，DxOmark没有评分，因此我们只选需要的，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>cdb=cdb[which(cdb$Mpix != <span class="string">'NA'</span>),] <span class="comment">#发现数据框规律，通过反选Mpix为NA的列</span>
cdbtested=cdb[which(cdb$Image == <span class="string">'TESTED'</span>),] <span class="comment">#选择经过测试的机型</span>
</pre></td></tr></table></figure>

<p>恰巧，得到的cdbtested也是214款机器。
<img src="/img/c6.png" alt="R"></p>
<p>接下来，要重新对cd1和cdbtested进行重新排列和合并。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="comment">#in order by camera names</span>
cd1ordered=cd1[order(cd1[,<span class="number">2</span>]),]
cdbtd=cdbtested[order(cdbtested[,<span class="number">2</span>]),]
cdnew=cbind(cd1ordered,cdbtd[,-<span class="number">1</span>])
</pre></td></tr></table></figure>

<p>你会发现数据框是字符格式，而且有的单元格是数字+单位的形式，为了对数据进行分析，我们需要去掉单位，将其转换为numeric格式。例如，把portrait分数中的22 bits，改成22。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>cdnew[,<span class="number">4</span>] = sub(<span class="string">'.....$'</span>,<span class="string">''</span>,cdnew[,<span class="number">4</span>])
</pre></td></tr></table></figure>

<p>其他依次类推。</p>
<p>下面，我们要把需要进行数据运算分析的列，从<code>character</code>转换成<code>numeric</code>，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>cdnew1=cdnew
cdnew1=droplevels(cdnew1)
cdnew1=data.frame(lapply(cdnew1,as.character),stringsAsFactors=<span class="literal">FALSE</span>)
cdnew1[,c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">15</span>)] =as.numeric(as.matrix(cdnew1[,c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">15</span>)]))
</pre></td></tr></table></figure>

<p>并修改一些数据转换产生的错误，比如4:3大小的传感器，被R识别为某种运算，所有4:3的单元格都成了0.16875，因此，也要排除这些转换错误，还好，数据量比较小，容易发现。这可能是我对数据格式不熟悉，造成的，应该可以通过修改代码解决。然后选择</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>cdnew1[which(cdnew1[,<span class="number">13</span>]==<span class="string">'0.16875'</span>),<span class="number">13</span>] = <span class="string">'4:3'</span>
cdnew1[which(cdnew1[,<span class="number">15</span>]==<span class="number">0</span>),<span class="number">15</span>] = <span class="literal">NA</span> <span class="comment">#一些空值为0，我们也不需要，所以一并转换为NA</span>
</pre></td></tr></table></figure>

<p>以上就完成了所有数据的采集过程，我用了一晚上，因为很多基础的知识不熟悉，需要搜索才能解决，其实后来再看R in Action这本书的时候，发现如果要用好R，还是要重头学起，不能断章取义（以上代码多少也有断章取义的，只做到解决问题，至于代码效率就没有考虑，也没有能力考虑了）。</p>
<p>接下来，要考虑如何分析这些数据了。先谈谈自己的看法，性价比这个东西很难界定，所以每个人要先设定自己的阈值，比如价格设在500美元，机器重量设在500g，就很满意了。当然，类似于像素等其他参数也可以考虑。这样的话，我考虑的性价比就包括了价格、机身重量和性能三项。公式很简单，</p>
<p>性价比指数 =  性能分数 / （价格 /  500 <em> 100）/  （机身重量 / 500 </em> 100）</p>
<p>价格和机身重量要乘以100是为了转换成和性能分数一致的百分制（此处很值得研究）。</p>
<p>然后我得到的结果是（代码就不放了），cdfinalscore越高，性价比越高。</p>
<p><img src="/img/c7.png" alt="R">
<img src="/img/c8.png" alt="R">
可见莱卡M9有多坑爹啊。</p>
<p>以上仅供个人参考，大家可以根据自己的喜好，设置不同的参数分析，对排名影响还是挺大的。下一步，我都想学学Python，定期抓取亚马逊的价格数据了。哎，时间不够用啊，不能不务正业啊。如果，这一块能做好，搞个小网站赚钱还是有搞头的。</p>
<p>P.S. 以上文中代码问题还请各位指正，纯新手和菜鸟，没有什么好的代码习惯。欢迎大家交流。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/菜鸟学R语言/" term="菜鸟学R语言"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[你压力大吗？]]></title>
    <link href="http://yangliufr.com/2013/05/01/are-you-stressed-out/"/>
    <id>http://yangliufr.com/2013/05/01/are-you-stressed-out/</id>
    <published>2013-05-01T00:00:00.000Z</published>
    <updated>2013-09-29T21:39:49.000Z</updated>
    <content type="html"><![CDATA[<p>今天是五一国际劳动节，据说，法国以所有日常的公共运输的停运和商家店铺的停业来庆祝这一劳动者的节日。紧接着的假期是5月8日的“二战胜利纪念日”和“耶稣升天节”。</p>
<p>来到法国之后，大部分时间还都是在实验室和宿舍度过的，不期而至的假期对我来说，就是要提前去超市屯点食物，和规划一下实验进度，因为超市和实验室都会很准时的关闭，仅此而已。而我大部分的工作是在电脑上完成，所以假期对我分析数据、看文献、写论文来说没有什么影响。
<a id="more"></a></p>
<p>在国内的女友看来，我在法国的生活简直是松散极了。其实，很多时候我是不同意的，但每当这些对我来说莫名其妙的假期来临的时候，我会很愧疚，因为与此同时，她还在国内辛苦的上班中。今天，她刚刚结束了短暂的五一假期回上海，她说，</p>
<blockquote>
<p>要好好工作了。钱到用时方恨少，带了2000回去，两天就花完了。</p>
</blockquote>
<p>她是个工作上很勤快，生活中很孝顺的女孩。和我一样硕士毕业，刚工作不到9个月时间。即便在上学的时候，每次回家，她都会给家里的爷爷奶奶爸爸妈妈哥哥嫂嫂和小侄子买大大小小的礼物，这回也不例外，给了长辈一点钱，给嫂子和侄子买了礼物，同时还参加了她同学的婚礼出了点份子钱。难怪这钱这么不禁花呢。</p>
<p>与之相比，我的生活确实如神仙一般。</p>
<p>即便是和中国人在一起，也不会去谈论国内的房价、物价和药价，更多关心的是中国面临的国际关系、人民意识形态价值观和突如其来的自然灾害等问题。和外国同事谈论的内容就更加轻松了，多半是吃的、喝的、玩的和工作。平时几乎感受不到在国内学习生活的那么多有形无形的压力，在这里的工作压力是自己给的，工作进度是自己定的，最起码我是这样，我的导师也从来没有给我任何deadline（最后期限）。</p>
<p>虽然我个人把我现在的博士阶段的学习当做一种工作，加上经常和父母和女友的交流，让我有点淡化的家庭责任感始终保持着，因为是公派生必须回国的原因，很多国内关系还需要细心维护着。但并不是所有同学都如此（这简直是一定的）。客观的说，就公派生而言，有的人工作进展按部就班，有的人则一筹莫展；有的人每隔一段时间会往家里寄钱，有的人还让家里的父母给自己寄大包大包的物资，美其名曰要省钱；有的人省吃俭用为了省下回国看望父母的机票，有的人精打细算为了买廉价机票漫无目的的周游欧洲各国。即便都来自中国，但每个人的价值观和家庭观念都还有很大的不同，也正是中国之大，让我们有了多元化的观念。这里没有对错褒贬，只是不同的生活方式。再说说我自己，周围有很多同学已经在上一个圣诞节假期去了欧洲各地玩了一趟，下周的假期他们还会外出游玩。他们每次都会叫我，知道我喜欢摄影，想让我帮他们拍照。但我每次都回绝了，多少有些对不住，因为我不想因为机票便宜去一个旅游计划外的国家到此一游，更多的是，我找不到出去旅游的理由。也许，我还没有找到生活的节奏吧。</p>
<p>所以，我跟女友说，有压力是好的，但别让这些自我压力和舆论压力压垮自己，别迷失方向就行。其实说起来很容易，具体度的把握只能靠自己慢慢调整。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/一些思考/" term="一些思考"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[遗憾与希望]]></title>
    <link href="http://yangliufr.com/2013/04/17/regret-and-hope/"/>
    <id>http://yangliufr.com/2013/04/17/regret-and-hope/</id>
    <published>2013-04-17T00:00:00.000Z</published>
    <updated>2013-09-29T21:42:14.000Z</updated>
    <content type="html"><![CDATA[<p>最近似乎很多事把时间塞满了，一个人捧着相机去参观了在图卢兹举行的日本文化展，而新买的镜头也到了，正想着春天来了，多拍点德味的图片；和同学去电影院看了来法国之后的第一部电影——Oblivion，正想着以后每周二晚上去看一场半价的电影；和队友一起和几个亚洲人打比赛练习，正想着多锻炼锻炼，为即将到来的华人篮球赛做准备；带我的博后把他论文里最后一个实验技能教给了我，正想着把第一批的最后一部分实验做完收工，好专心把论文写完……</p>
<a id="more"></a>

<p>但这些事我最近都干不了。就在昨天下班后，我一个人拿起篮球去操场练习，变向过人时用力过大，不小心扭到了脚踝。倒下去的那一刻心里凉了一下，脚疼得不停抽搐，我索性仰天躺在了水泥地上仰望湛蓝的天空，似乎这世界都是我的，又在离我而去。艰难回去后只能躺在床上把脚抬高，啥事都做不了，下床做个饭上个厕所，脚都会因为血液流动肿的老高。我承认我是个矫情的人，不然也不会成为文艺青年。在国内本科时也扭到过脚，那次肿的更严重，但住学校集体宿舍有人照顾帮忙带饭，以至于现在一点印象都没有。</p>
<p>这两天在这个地球上还发生了几件事，结合我个人的经历，让我再次有了对生命的感慨。</p>
<blockquote>
<p>复旦医学院学生被室友投毒而亡，受害者刚被保送读博；</p>
<p>波士顿马拉松赛终点的爆炸事件导致数人死亡、数百人受伤，其中一位女性受害者的男友正准备在比赛结束时向她求婚；</p>
<p>伊朗发生7.8级地震，邻国巴基斯坦死亡数十人；</p>
<p>H7N9禽流感夺去了数十人的生命，其中就有我在图卢兹同学实验室的一位师姐的母亲。</p>
</blockquote>
<p>因为怕脚肿，一个人在家里脚抬高地躺了一天，什么也做不了。拿着iPad看到了以上新闻，可挖掘的新闻点似乎都不一样，但都是生命的终结，身后都留下了无数令人唏嘘的遗憾。</p>
<p>我想，如果我住的附近如果发生什么突发事件，但我连跑都跑不了，只能接受现实吗？当然不是，正是因为有了生命的戛然而止，那我更应该让生命随时绽放。很多事都等到失去的时候才懂得珍惜，为何不从现在开始珍惜自己拥有的一切呢？</p>
<p>关于生命，可以写的东西很多很多，自己也有很多要说的话，但我还是写不出来，感觉在生命面前，我的语言没有任何魅力，都失去了意义。写这篇博文，更多的是让自己记住这一刻的感受，有点矫情，有点娇气，有对逝者故去的悲伤，也有对生者未来的希望。</p>
<p>最后，希望自己的家人朋友同学，以及世界上的所有人都平平安安，健健康康。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/一些思考/" term="一些思考"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[难以下咽的食物：中国化肥背后的真相]]></title>
    <link href="http://yangliufr.com/2013/04/08/truth-of-chinese-fertilizer/"/>
    <id>http://yangliufr.com/2013/04/08/truth-of-chinese-fertilizer/</id>
    <published>2013-04-08T00:00:00.000Z</published>
    <updated>2013-09-27T17:05:10.000Z</updated>
    <content type="html"><![CDATA[<p><em>译者的话：前几天那个已经被撤职的环保局长，用红豆煮的水也是红色的来解释地下水污染。今天看到新闻，中国近年来每6分钟就有一人被确诊为癌症。而关于水污染的报道更不鲜见了，所以我也能预料到我这篇译文没有任何点击量，愿意读这篇文章的人甚至比看我的zotero教程都更小众。麻木归麻木了，但该做的事情，我依然会做。绿色和平这个国际组织的报道还是有别于一般媒体的，和其他国际组织一样，其视角会有些不同，没有记者，如纪录片一样，但仍发人深思。</em>
<a id="more"></a>
当谈及“食物”时，印入人们脑海中的可能是各种食品的营销广告。但在食品产业背后，有着那和化肥有关而又不堪描绘的丑陋的另一面。</p>
<p>绿色和平（东亚）发起了一项调查活动，关注了中国最重要的磷肥生产地四川省，来揭示这一片不堪和难以下咽。</p>
<p><a href="http://www.greenpeace.org/eastasia/living-with-danger-report/" target="_blank">调查结果</a>显示，中国有着非常普遍的严重环境问题，大量含有磷肥废料（磷石膏）的有毒化学物质，竟被开放地丢弃在了当地得几座村庄旁边。</p>
<p>样品分析结果显示，氟化物（一种潜在的有毒物质）含量在当地几个采集点都超出了国家对有毒废弃物规定的安全标准。其中，有一处20米高的废渣，就临堆放在村庄旁边，废渣的沥出液中氟化物超出国标7倍之多。</p>
<p>当地村民已经被磷肥生产企业和政府的不作为行为激怒了，自发组织购买了一辆铲车，开始了去除有毒废物的行动。</p>
<p>下面这个纪录片名为“How China&#39;s fertilizer industry is endangering villager lives（中国化肥工业正危及村民生命）”</p>
<p>YouTube视频：<a href="http://www.youtube.com/watch?feature=player_embedded&amp;v=vZJBBldOTeQ" target="_blank">请点击</a></p>
<p>尽管我们并不鼓励村民做出这种有潜在危险的行为，但村民用行动告诉大家，他们仍爱着这片土地和村庄，但他们的心在滴血。同时，这也在向当地政府释放出挑战的信号，对其不为人民服务的行为做出了警告。</p>
<p>绿色和平（东亚）的这次调查所提供的视频证据，是对重工业化已经渗透进农业和食品生产系统中无法自拔的又一个鲜活事例。化工集约农业<a href="http://www.greenpeace.to/greenpeace/wp-content/uploads/2012/06/Tirado-and-Allsopp-2012-Phosphorus-in-Agriculture-Technical-Report-02-2012.pdf" target="_blank">使用了大量的合成化肥</a>，其生产中产生大量废弃物，对环境和人类生存造成了极大的破坏和威胁。</p>
<p>我们<a href="http://www.greenpeace.org/international/en/campaigns/agriculture/solution-ecological-farming/solutions/" target="_blank">认为</a>，农业和食品生产并不需如此严重地依赖化肥的使用。我们眼中的农业生产都是基于有机施肥技术（绿色堆肥、作物轮作和养分循环），用一种更环境友好的方式来进行耕作。</p>
<p>尽管农业产业一直都想抵赖，但一个真正的生态系统是可以为全人类生产食物而不需要使用化学肥料的。</p>
<p>我们必须从生态环保的方法开始，这不仅是为了这些受影响的中国四川的村民们，而是为了全球人民，让我们在餐桌上的食物不是以牺牲环境和人类未来的代价换来的。</p>
<p>本文英文原文作者：<a href="http://www.greenpeace.org/international/en/news/Blogs/makingwaves/chemical-fertilisers-china/blog/44517/" target="_blank">Alessandro Saccoccio</a>，是绿色和平（国际）的生态农业市场传媒部主管。</p>
]]></content>
    <category scheme="http://yangliufr.com/tags/绿色和平/" term="绿色和平"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[文献管理软件Zotero教程：第一集]]></title>
    <link href="http://yangliufr.com/2013/04/03/zotero-1/"/>
    <id>http://yangliufr.com/2013/04/03/zotero-1/</id>
    <published>2013-04-03T00:00:00.000Z</published>
    <updated>2013-09-28T13:42:20.000Z</updated>
    <content type="html"><![CDATA[<p>第一集主要为新手介绍如何安装Zotero，以及基本的使用方法，内容很简单。为了观看更清晰，视频会分别存放在YouTube和Youku上，文章中贴出Youku的播放器（很不清晰），以及YouTube的播放地址以及百度盘的下载地址，欢迎转载，请注明出处即可。
<a id="more"></a>
推荐大家下载观看，或者点击优酷的右下角——返回优酷观看，会达到最佳效果，原片均为720P的清晰度。</p>
<p>本站再次更换了新的主题，主要为了让大家在博客中直接观看视频更方便，原主题的文章页宽度太窄。</p>
<p>YouTube地址：<a href="https://www.youtube.com/watch?v=sC7OqGJdopg" target="_blank">点我</a></p>
<p>百度盘下载地址：<a href="http://pan.baidu.com/share/link?shareid=458907&amp;uk=3859037351" target="_blank">点我</a></p>
]]></content>
    <category scheme="http://yangliufr.com/tags/文献管理软件/" term="文献管理软件"/>
  </entry>
</feed>
